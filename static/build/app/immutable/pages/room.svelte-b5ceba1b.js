import{S as J,i as K,s as X,l as T,g as k,e as _,c as b,b as f,d,T as de,a as y,n as M,J as g,t as B,k as z,h as S,m as U,j as ue,P as te,L as le,U as Oe,V as oe,W as ne,f as ve,x as V,y as G,X as ke,z as W,r as P,p as C,C as H,o as se,q as fe,Y as Re,Z as qe,M as we,N as Ve,_ as Ge,$ as We,w as He}from"../chunks/index-e18ba743.js";import{T as Je}from"../chunks/TopBar-b4235a47.js";let re,ae;const Ke=async r=>{re=await(await fetch("/info")).json(),ae=re.clientConfig};function ye(r,e,l){const t=r.slice();return t[1]=e[l][0],t[2]=e[l][1],t}function xe(r,e,l){const t=r.slice();return t[5]=e[l],t}function De(r){let e,l,t;return{c(){e=_("link"),this.h()},l(n){e=b(n,"LINK",{rel:!0,as:!0,href:!0}),this.h()},h(){f(e,"rel","preload"),f(e,"as",l=r[1]),f(e,"href",t=r[5])},m(n,i){k(n,e,i)},p(n,i){i&1&&l!==(l=n[1])&&f(e,"as",l),i&1&&t!==(t=n[5])&&f(e,"href",t)},d(n){n&&d(e)}}}function Ne(r){let e,l=r[2],t=[];for(let n=0;n<l.length;n+=1)t[n]=De(xe(r,l,n));return{c(){for(let n=0;n<t.length;n+=1)t[n].c();e=T()},l(n){for(let i=0;i<t.length;i+=1)t[i].l(n);e=T()},m(n,i){for(let o=0;o<t.length;o+=1)t[o].m(n,i);k(n,e,i)},p(n,i){if(i&1){l=n[2];let o;for(o=0;o<l.length;o+=1){const a=xe(n,l,o);t[o]?t[o].p(a,i):(t[o]=De(a),t[o].c(),t[o].m(e.parentNode,e))}for(;o<t.length;o+=1)t[o].d(1);t.length=l.length}},d(n){de(t,n),n&&d(e)}}}function Xe(r){let e,l=Object.entries(r[0]),t=[];for(let n=0;n<l.length;n+=1)t[n]=Ne(ye(r,l,n));return{c(){e=_("main");for(let n=0;n<t.length;n+=1)t[n].c()},l(n){e=b(n,"MAIN",{});var i=y(e);for(let o=0;o<t.length;o+=1)t[o].l(i);i.forEach(d)},m(n,i){k(n,e,i);for(let o=0;o<t.length;o+=1)t[o].m(e,null)},p(n,[i]){if(i&1){l=Object.entries(n[0]);let o;for(o=0;o<l.length;o+=1){const a=ye(n,l,o);t[o]?t[o].p(a,i):(t[o]=Ne(a),t[o].c(),t[o].m(e,null))}for(;o<t.length;o+=1)t[o].d(1);t.length=l.length}},i:M,o:M,d(n){n&&d(e),de(t,n)}}}function Ye(r,e,l){let{assetsToPreload:t}=e;return r.$$set=n=>{"assetsToPreload"in n&&l(0,t=n.assetsToPreload)},[t]}class Ze extends J{constructor(e){super(),K(this,e,Ye,Xe,X,{assetsToPreload:0})}}var Ae="/app/immutable/assets/download-ddd256eb.svg",he="/app/immutable/assets/close-02f49dd1.svg",Be="/app/immutable/assets/timer-plus-0c3cdcef.svg",Se="/app/immutable/assets/file-document-outline-8da5362f.svg";function Ee(r,e,l){const t=r.slice();return t[6]=e[l],t[8]=l,t}function Ie(r){let e,l;function t(o,a){return o[2]==-1?$e:Qe}let n=t(r),i=n(r);return{c(){e=_("div"),l=_("p"),i.c(),this.h()},l(o){e=b(o,"DIV",{class:!0});var a=y(e);l=b(a,"P",{class:!0});var s=y(l);i.l(s),s.forEach(d),a.forEach(d),this.h()},h(){f(l,"class","svelte-lj1lm6"),f(e,"class","svelte-lj1lm6")},m(o,a){k(o,e,a),g(e,l),i.m(l,null)},p(o,a){n===(n=t(o))&&i?i.p(o,a):(i.d(1),i=n(o),i&&(i.c(),i.m(l,null)))},d(o){o&&d(e),i.d()}}}function Qe(r){let e,l,t=r[4],n=[];for(let o=0;o<t.length;o+=1)n[o]=Te(Ee(r,t,o));let i=r[2]!=2&&Ce(r);return{c(){for(let o=0;o<n.length;o+=1)n[o].c();e=z(),i&&i.c(),l=T()},l(o){for(let a=0;a<n.length;a+=1)n[a].l(o);e=U(o),i&&i.l(o),l=T()},m(o,a){for(let s=0;s<n.length;s+=1)n[s].m(o,a);k(o,e,a),i&&i.m(o,a),k(o,l,a)},p(o,a){if(a&16){t=o[4];let s;for(s=0;s<t.length;s+=1){const c=Ee(o,t,s);n[s]?n[s].p(c,a):(n[s]=Te(c),n[s].c(),n[s].m(e.parentNode,e))}for(;s<n.length;s+=1)n[s].d(1);n.length=t.length}o[2]!=2?i?i.p(o,a):(i=Ce(o),i.c(),i.m(l.parentNode,l)):i&&(i.d(1),i=null)},d(o){de(n,o),o&&d(e),i&&i.d(o),o&&d(l)}}}function $e(r){let e,l=r[1]&&Me(r);return{c(){l&&l.c(),e=T()},l(t){l&&l.l(t),e=T()},m(t,n){l&&l.m(t,n),k(t,e,n)},p(t,n){t[1]?l?l.p(t,n):(l=Me(t),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null)},d(t){l&&l.d(t),t&&d(e)}}}function Pe(r){let e;return{c(){e=_("br")},l(l){e=b(l,"BR",{})},m(l,t){k(l,e,t)},d(l){l&&d(e)}}}function Te(r){let e=r[6]+"",l,t,n,i=r[8]!=r[4].length-1&&Pe();return{c(){l=B(e),t=z(),i&&i.c(),n=T()},l(o){l=S(o,e),t=U(o),i&&i.l(o),n=T()},m(o,a){k(o,l,a),k(o,t,a),i&&i.m(o,a),k(o,n,a)},p(o,a){a&16&&e!==(e=o[6]+"")&&ue(l,e),o[8]!=o[4].length-1?i||(i=Pe(),i.c(),i.m(n.parentNode,n)):i&&(i.d(1),i=null)},d(o){o&&d(l),o&&d(t),i&&i.d(o),o&&d(n)}}}function Ce(r){let e,l,t,n,i;return{c(){e=_("button"),l=_("img"),this.h()},l(o){e=b(o,"BUTTON",{type:!0,title:!0,class:!0});var a=y(e);l=b(a,"IMG",{src:!0,width:!0,height:!0,alt:!0,class:!0}),a.forEach(d),this.h()},h(){te(l.src,t=he)||f(l,"src",t),f(l,"width","24"),f(l,"height","24"),f(l,"alt","Close"),f(l,"class","svelte-lj1lm6"),f(e,"type","button"),f(e,"title","Close"),f(e,"class","svelte-lj1lm6")},m(o,a){k(o,e,a),g(e,l),n||(i=le(e,"click",function(){Oe(r[3])&&r[3].apply(this,arguments)}),n=!0)},p(o,a){r=o},d(o){o&&d(e),n=!1,i()}}}function Me(r){let e;function l(i,o){return i[0]?tt:et}let t=l(r),n=t(r);return{c(){n.c(),e=T()},l(i){n.l(i),e=T()},m(i,o){n.m(i,o),k(i,e,o)},p(i,o){t!==(t=l(i))&&(n.d(1),n=t(i),n&&(n.c(),n.m(e.parentNode,e)))},d(i){n.d(i),i&&d(e)}}}function et(r){let e;return{c(){e=B("Connecting...")},l(l){e=S(l,"Connecting...")},m(l,t){k(l,e,t)},d(l){l&&d(e)}}}function tt(r){let e,l,t;return{c(){e=B("Connection error. "),l=_("br"),t=B(`
							Will continue to retry...`)},l(n){e=S(n,"Connection error. "),l=b(n,"BR",{}),t=S(n,`
							Will continue to retry...`)},m(n,i){k(n,e,i),k(n,l,i),k(n,t,i)},d(n){n&&d(e),n&&d(l),n&&d(t)}}}function lt(r){let e,l=(r[2]!=-1||r[1])&&Ie(r);return{c(){e=_("main"),l&&l.c(),this.h()},l(t){e=b(t,"MAIN",{class:!0});var n=y(e);l&&l.l(n),n.forEach(d),this.h()},h(){f(e,"class","svelte-lj1lm6")},m(t,n){k(t,e,n),l&&l.m(e,null)},p(t,[n]){t[2]!=-1||t[1]?l?l.p(t,n):(l=Ie(t),l.c(),l.m(e,null)):l&&(l.d(1),l=null)},i:M,o:M,d(t){t&&d(e),l&&l.d()}}}function ot(r,e,l){let t,{isNetworkError:n}=e,{loading:i}=e,{popupMessageCode:o}=e,{handlePopupClose:a}=e;const s=[["Oh no,","looks like that file's too big."],["That's annoying,","the upload failed due to a connection error."],["Welp,","the server's currently out of rooms."],["Huh,","the server's at its total file count limit."],["Hmm,","the server currently doesn't have enough space."]];return s[99]=["Huh,","that's an unknown error."],r.$$set=c=>{"isNetworkError"in c&&l(0,n=c.isNetworkError),"loading"in c&&l(1,i=c.loading),"popupMessageCode"in c&&l(2,o=c.popupMessageCode),"handlePopupClose"in c&&l(3,a=c.handlePopupClose)},r.$$.update=()=>{r.$$.dirty&36&&l(4,t=s[o])},[n,i,o,a,t,s]}class nt extends J{constructor(e){super(),K(this,e,ot,lt,X,{isNetworkError:0,loading:1,popupMessageCode:2,handlePopupClose:3})}}const ie={time:(r,e)=>{let l=Math.floor(r/3600);r-=l*(60*60);let t=Math.floor(r/60);r-=t*60;let i=[l,t,r];return i.splice(0,i.length-e),i.map(o=>o.toString().padStart(2,"0")).join(":")},shorten:(r,e)=>r.length<e?r:r.slice(0,e-3)+"..."};function it(r){let e,l,t,n,i,o;return{c(){e=_("main"),l=oe("svg"),t=oe("circle"),n=oe("circle"),o=oe("circle"),this.h()},l(a){e=b(a,"MAIN",{});var s=y(e);l=ne(s,"svg",{viewBox:!0,class:!0});var c=y(l);t=ne(c,"circle",{id:!0,cx:!0,cy:!0,r:!0,class:!0}),y(t).forEach(d),n=ne(c,"circle",{id:!0,style:!0,"stroke-dasharray":!0,"stroke-width":!0,cx:!0,cy:!0,r:!0,transform:!0,class:!0}),y(n).forEach(d),o=ne(c,"circle",{id:!0,"stroke-width":!0,cx:!0,cy:!0,r:!0,class:!0}),y(o).forEach(d),c.forEach(d),s.forEach(d),this.h()},h(){f(t,"id","background"),f(t,"cx","0.5"),f(t,"cy","0.5"),f(t,"r","0.5"),f(t,"class","svelte-f8zowc"),f(n,"id","slice"),ve(n,"transition-duration",r[1]+"s"),f(n,"stroke-dasharray",i=r[0]*(Math.PI/2)+" 3.141592653589793"),f(n,"stroke-width","0.5"),f(n,"cx","0.5"),f(n,"cy","0.5"),f(n,"r","0.25"),f(n,"transform","rotate(-90) translate(-1)"),f(n,"class","svelte-f8zowc"),f(o,"id","outline"),f(o,"stroke-width",ee),f(o,"cx","0.5"),f(o,"cy","0.5"),f(o,"r","0.5"),f(o,"class","svelte-f8zowc"),f(l,"viewBox",-ee/2+" "+-ee/2+" "+(1+ee)+" "+(1+ee)),f(l,"class","svelte-f8zowc")},m(a,s){k(a,e,s),g(e,l),g(l,t),g(l,n),g(l,o)},p(a,[s]){s&2&&ve(n,"transition-duration",a[1]+"s"),s&1&&i!==(i=a[0]*(Math.PI/2)+" 3.141592653589793")&&f(n,"stroke-dasharray",i)},i:M,o:M,d(a){a&&d(e)}}}const ee=.015;function rt(r,e,l){let{amount:t}=e,{interpolateTime:n}=e;return r.$$set=i=>{"amount"in i&&l(0,t=i.amount),"interpolateTime"in i&&l(1,n=i.interpolateTime)},[t,n]}class at extends J{constructor(e){super(),K(this,e,rt,it,X,{amount:0,interpolateTime:1})}}function ze(r){let e,l,t,n,i,o,a,s,c,w,m,u;return{c(){e=_("div"),l=_("button"),t=_("img"),i=z(),o=_("a"),a=_("img"),this.h()},l(v){e=b(v,"DIV",{class:!0});var h=y(e);l=b(h,"BUTTON",{title:!0,class:!0});var x=y(l);t=b(x,"IMG",{src:!0,width:!0,height:!0,alt:!0,class:!0}),x.forEach(d),i=U(h),o=b(h,"A",{href:!0,download:!0,title:!0,class:!0});var O=y(o);a=b(O,"IMG",{src:!0,widt:!0,height:!0,alt:!0,class:!0}),O.forEach(d),h.forEach(d),this.h()},h(){te(t.src,n=Be)||f(t,"src",n),f(t,"width","24"),f(t,"height","24"),f(t,"alt","Extend file time limit"),f(t,"class","svelte-baxtgf"),f(l,"title","Extend the time limit"),f(l,"class","svelte-baxtgf"),te(a.src,s=Ae)||f(a,"src",s),f(a,"widt","24"),f(a,"height","24"),f(a,"alt","Download the file"),f(a,"class","svelte-baxtgf"),f(o,"href",c=`/room/get/${r[0]}/${r[2]}`),f(o,"download",w=r[1].fileName),f(o,"title","Download the file"),f(o,"class","svelte-baxtgf"),f(e,"class","bottom svelte-baxtgf")},m(v,h){k(v,e,h),g(e,l),g(l,t),g(e,i),g(e,o),g(o,a),m||(u=le(l,"click",r[5]),m=!0)},p(v,h){h&5&&c!==(c=`/room/get/${v[0]}/${v[2]}`)&&f(o,"href",c),h&2&&w!==(w=v[1].fileName)&&f(o,"download",w)},d(v){v&&d(e),m=!1,u()}}}function st(r){let e,l,t,n,i,o,a,s,c,w,m=(r[1].ready?r[1].downloading?"Downloading...":ie.time(r[1].timeLeft,2):`${Math.floor(r[1].uploadProgress*100)}% Uploaded`)+"",u,v,h,x,O,Y,D,j,E,F=ie.shorten(r[1].fileName,30)+"",R,Z,L,q,A,ce,me;s=new at({props:{amount:r[1].ready?r[1].timeLeft/(r[1].quickDownloadDelete?r[3].downloadedFile:r[3].newFile):r[1].uploadProgress,interpolateTime:ae.timings.refreshDelay}});let I=r[1].ready&&ze(r);return{c(){e=_("main"),l=_("div"),t=_("img"),i=z(),o=_("div"),a=_("div"),V(s.$$.fragment),c=z(),w=_("span"),u=B(m),v=z(),h=_("button"),x=_("img"),j=z(),E=_("p"),R=B(F),Z=z(),I&&I.c(),L=z(),q=_("br"),this.h()},l(p){e=b(p,"MAIN",{class:!0});var N=y(e);l=b(N,"DIV",{class:!0});var $=y(l);t=b($,"IMG",{src:!0,width:!0,height:!0,alt:!0,class:!0}),$.forEach(d),i=U(N),o=b(N,"DIV",{class:!0});var Q=y(o);a=b(Q,"DIV",{class:!0});var ge=y(a);G(s.$$.fragment,ge),ge.forEach(d),c=U(Q),w=b(Q,"SPAN",{class:!0});var pe=y(w);u=S(pe,m),pe.forEach(d),v=U(Q),h=b(Q,"BUTTON",{title:!0,class:!0});var _e=y(h);x=b(_e,"IMG",{src:!0,width:!0,height:!0,alt:!0,class:!0}),_e.forEach(d),Q.forEach(d),j=U(N),E=b(N,"P",{class:!0});var be=y(E);R=S(be,F),be.forEach(d),Z=U(N),I&&I.l(N),L=U(N),q=b(N,"BR",{}),N.forEach(d),this.h()},h(){te(t.src,n=Se)||f(t,"src",n),f(t,"width","24"),f(t,"height","24"),f(t,"alt","A file icon"),f(t,"class","svelte-baxtgf"),f(l,"class","background svelte-baxtgf"),f(a,"class","piechart svelte-baxtgf"),f(w,"class","svelte-baxtgf"),ke(w,"warning",r[1].ready&&!r[1].downloading&&r[1].timeLeft<=15),te(x.src,O=he)||f(x,"src",O),f(x,"width","24"),f(x,"height","24"),f(x,"alt",Y=r[1].ready?"Delete the file":"Cancel upload"),f(x,"class","svelte-baxtgf"),f(h,"title",D=r[1].ready?"Delete the file":"Cancel upload"),f(h,"class","svelte-baxtgf"),f(o,"class","top svelte-baxtgf"),f(E,"class","title svelte-baxtgf"),f(e,"class","svelte-baxtgf")},m(p,N){k(p,e,N),g(e,l),g(l,t),g(e,i),g(e,o),g(o,a),W(s,a,null),g(o,c),g(o,w),g(w,u),g(o,v),g(o,h),g(h,x),g(e,j),g(e,E),g(E,R),g(e,Z),I&&I.m(e,null),g(e,L),g(e,q),A=!0,ce||(me=le(h,"click",r[4]),ce=!0)},p(p,[N]){const $={};N&2&&($.amount=p[1].ready?p[1].timeLeft/(p[1].quickDownloadDelete?p[3].downloadedFile:p[3].newFile):p[1].uploadProgress),s.$set($),(!A||N&2)&&m!==(m=(p[1].ready?p[1].downloading?"Downloading...":ie.time(p[1].timeLeft,2):`${Math.floor(p[1].uploadProgress*100)}% Uploaded`)+"")&&ue(u,m),N&2&&ke(w,"warning",p[1].ready&&!p[1].downloading&&p[1].timeLeft<=15),(!A||N&2&&Y!==(Y=p[1].ready?"Delete the file":"Cancel upload"))&&f(x,"alt",Y),(!A||N&2&&D!==(D=p[1].ready?"Delete the file":"Cancel upload"))&&f(h,"title",D),(!A||N&2)&&F!==(F=ie.shorten(p[1].fileName,30)+"")&&ue(R,F),p[1].ready?I?I.p(p,N):(I=ze(p),I.c(),I.m(e,L)):I&&(I.d(1),I=null)},i(p){A||(P(s.$$.fragment,p),A=!0)},o(p){C(s.$$.fragment,p),A=!1},d(p){p&&d(e),H(s),I&&I.d(),ce=!1,me()}}}function ft(r,e,l){const t=re.timings.delete;let{roomName:n}=e,{file:i}=e,{fileID:o}=e,{index:a}=e,{handleDelete:s}=e,{handleExtend:c}=e;const w=u=>{s(o)},m=u=>{c(o)};return r.$$set=u=>{"roomName"in u&&l(0,n=u.roomName),"file"in u&&l(1,i=u.file),"fileID"in u&&l(6,o=u.fileID),"index"in u&&l(2,a=u.index),"handleDelete"in u&&l(7,s=u.handleDelete),"handleExtend"in u&&l(8,c=u.handleExtend)},[n,i,a,t,w,m,o,s,c]}class ct extends J{constructor(e){super(),K(this,e,ft,st,X,{roomName:0,file:1,fileID:6,index:2,handleDelete:7,handleExtend:8})}}function Ue(r,e,l){const t=r.slice();return t[4]=e[l],t[6]=l,t}function ut(r){let e=[],l=new Map,t,n,i=r[1].files;const o=a=>a[6];for(let a=0;a<i.length;a+=1){let s=Ue(r,i,a),c=o(s);l.set(c,e[a]=Fe(c,s))}return{c(){for(let a=0;a<e.length;a+=1)e[a].c();t=T()},l(a){for(let s=0;s<e.length;s+=1)e[s].l(a);t=T()},m(a,s){for(let c=0;c<e.length;c+=1)e[c].m(a,s);k(a,t,s),n=!0},p(a,s){s&15&&(i=a[1].files,se(),e=Re(e,s,o,1,a,i,l,t.parentNode,qe,Fe,t,Ue),fe())},i(a){if(!n){for(let s=0;s<i.length;s+=1)P(e[s]);n=!0}},o(a){for(let s=0;s<e.length;s+=1)C(e[s]);n=!1},d(a){for(let s=0;s<e.length;s+=1)e[s].d(a);a&&d(t)}}}function dt(r){let e,l,t,n;return{c(){e=_("p"),l=B("Looks like there aren't any files here yet. "),t=_("br"),n=B(`
            Try uploading one by dropping it here or by clicking the upload button.`),this.h()},l(i){e=b(i,"P",{class:!0});var o=y(e);l=S(o,"Looks like there aren't any files here yet. "),t=b(o,"BR",{}),n=S(o,`
            Try uploading one by dropping it here or by clicking the upload button.`),o.forEach(d),this.h()},h(){f(e,"class","bold svelte-13gsupi")},m(i,o){k(i,e,o),g(e,l),g(e,t),g(e,n)},p:M,i:M,o:M,d(i){i&&d(e)}}}function je(r){let e,l;return e=new ct({props:{roomName:r[0],file:r[4],fileID:r[6],index:r[6],handleDelete:r[2],handleExtend:r[3]}}),{c(){V(e.$$.fragment)},l(t){G(e.$$.fragment,t)},m(t,n){W(e,t,n),l=!0},p(t,n){const i={};n&1&&(i.roomName=t[0]),n&2&&(i.file=t[4]),n&2&&(i.fileID=t[6]),n&2&&(i.index=t[6]),n&4&&(i.handleDelete=t[2]),n&8&&(i.handleExtend=t[3]),e.$set(i)},i(t){l||(P(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function Fe(r,e){let l,t,n,i=e[4]!=null&&je(e);return{key:r,first:null,c(){l=T(),i&&i.c(),t=T(),this.h()},l(o){l=T(),i&&i.l(o),t=T(),this.h()},h(){this.first=l},m(o,a){k(o,l,a),i&&i.m(o,a),k(o,t,a),n=!0},p(o,a){e=o,e[4]!=null?i?(i.p(e,a),a&2&&P(i,1)):(i=je(e),i.c(),P(i,1),i.m(t.parentNode,t)):i&&(se(),C(i,1,1,()=>{i=null}),fe())},i(o){n||(P(i),n=!0)},o(o){C(i),n=!1},d(o){o&&d(l),i&&i.d(o),o&&d(t)}}}function ht(r){let e,l,t,n;const i=[dt,ut],o=[];function a(s,c){return s[1].files.length==0?0:1}return l=a(r),t=o[l]=i[l](r),{c(){e=_("main"),t.c()},l(s){e=b(s,"MAIN",{});var c=y(e);t.l(c),c.forEach(d)},m(s,c){k(s,e,c),o[l].m(e,null),n=!0},p(s,[c]){let w=l;l=a(s),l===w?o[l].p(s,c):(se(),C(o[w],1,1,()=>{o[w]=null}),fe(),t=o[l],t?t.p(s,c):(t=o[l]=i[l](s),t.c()),P(t,1),t.m(e,null))},i(s){n||(P(t),n=!0)},o(s){C(t),n=!1},d(s){s&&d(e),o[l].d()}}}function mt(r,e,l){let{roomName:t}=e,{roomData:n}=e,{handleDelete:i}=e,{handleExtend:o}=e;return r.$$set=a=>{"roomName"in a&&l(0,t=a.roomName),"roomData"in a&&l(1,n=a.roomData),"handleDelete"in a&&l(2,i=a.handleDelete),"handleExtend"in a&&l(3,o=a.handleExtend)},[t,n,i,o]}class gt extends J{constructor(e){super(),K(this,e,mt,ht,X,{roomName:0,roomData:1,handleDelete:2,handleExtend:3})}}function pt(r){let e,l;return{c:M,l:M,m(t,n){e||(l=[le(window,"dragover",we(r[2])),le(window,"drop",we(r[0]))],e=!0)},p:M,i:M,o:M,d(t){e=!1,Ve(l)}}}function _t(r,e,l){let{handleUpload:t}=e;const n=o=>{let a=o.dataTransfer.items;if(a){let s=[];for(let c of a)c.kind=="file"&&s.push(c.getAsFile());s.length!=0&&t(s)}};function i(o){Ge.call(this,r,o)}return r.$$set=o=>{"handleUpload"in o&&l(1,t=o.handleUpload)},[n,t,i]}class bt extends J{constructor(e){super(),K(this,e,_t,pt,X,{handleUpload:1})}}function Le(r){let e,l;return e=new gt({props:{roomName:r[1],roomData:r[0],handleDelete:r[8],handleExtend:r[9]}}),{c(){V(e.$$.fragment)},l(t){G(e.$$.fragment,t)},m(t,n){W(e,t,n),l=!0},p(t,n){const i={};n&2&&(i.roomName=t[1]),n&1&&(i.roomData=t[0]),e.$set(i)},i(t){l||(P(e.$$.fragment,t),l=!0)},o(t){C(e.$$.fragment,t),l=!1},d(t){H(e,t)}}}function vt(r){let e,l,t,n,i,o,a,s,c,w;e=new Ze({props:{assetsToPreload:r[5]}}),n=new Je({props:{handleUpload:r[6],enableUpload:!r[2]}}),o=new nt({props:{isNetworkError:r[3],loading:r[2],popupMessageCode:r[4],handlePopupClose:r[7]}});let m=!r[2]&&Le(r);return c=new bt({props:{handleUpload:r[6]}}),{c(){V(e.$$.fragment),l=z(),t=_("main"),V(n.$$.fragment),i=z(),V(o.$$.fragment),a=z(),m&&m.c(),s=z(),V(c.$$.fragment)},l(u){const v=We('[data-svelte="svelte-1xhi3u4"]',document.head);G(e.$$.fragment,v),v.forEach(d),l=U(u),t=b(u,"MAIN",{});var h=y(t);G(n.$$.fragment,h),i=U(h),G(o.$$.fragment,h),a=U(h),m&&m.l(h),s=U(h),G(c.$$.fragment,h),h.forEach(d)},m(u,v){W(e,document.head,null),k(u,l,v),k(u,t,v),W(n,t,null),g(t,i),W(o,t,null),g(t,a),m&&m.m(t,null),g(t,s),W(c,t,null),w=!0},p(u,[v]){const h={};v&4&&(h.enableUpload=!u[2]),n.$set(h);const x={};v&8&&(x.isNetworkError=u[3]),v&4&&(x.loading=u[2]),v&16&&(x.popupMessageCode=u[4]),o.$set(x),u[2]?m&&(se(),C(m,1,1,()=>{m=null}),fe()):m?(m.p(u,v),v&4&&P(m,1)):(m=Le(u),m.c(),P(m,1),m.m(t,s))},i(u){w||(P(e.$$.fragment,u),P(n.$$.fragment,u),P(o.$$.fragment,u),P(m),P(c.$$.fragment,u),w=!0)},o(u){C(e.$$.fragment,u),C(n.$$.fragment,u),C(o.$$.fragment,u),C(m),C(c.$$.fragment,u),w=!1},d(u){H(e),u&&d(l),u&&d(t),H(n),H(o),m&&m.d(),H(c)}}}function kt(r,e,l){const t={image:[Ae,he,Be,Se]},n=.75*1e3;let i,o,a=!0,s,c=!1;const w=async D=>{if(h==2)return;let j=Date.now();try{let E=await fetch(`/room/get/${o}`);E.ok?l(0,i=await E.json()):(l(0,i=null),l(3,c=!1),await E.text()=="NoRooms"?l(4,h=2):l(4,h=99))}catch{l(0,i=null),l(3,c=!0)}i?a&&(s=setTimeout(E=>{l(2,a=!1)},n-(Date.now()-j))):(l(2,a=!0),s!=null&&clearTimeout(s))},m=D=>{location.href="/"};let u=new Map;const v=D=>{if(a)return;let j=!1;for(let E of D){if(E.size>ae.max.fileSize){j=!0;continue}let F=i.files.length,R=new FormData;R.set("upload",E);let Z=new AbortController;fetch(`/room/upload/${o}`,{method:"POST",body:R,signal:Z.signal}).then(async L=>{if(u.delete(F),L.ok)return;let q=await L.text();q=="FileTooBig"?l(4,h=0):q=="TooManyFiles"?l(4,h=3):q=="NoSpace"?l(4,h=4):l(4,h=99)}).catch(L=>{u.delete(F),L.name!="AbortSignal"&&l(4,h=1)}),u.set(F,Z),l(0,i.files[F]={fileName:E.name,timeLeft:0,ready:!1,uploadProgress:0,size:E.size},i)}j&&l(4,h=0)};let h=-1;const x=D=>{l(4,h=-1)},O=D=>{i.files[D].ready?(fetch(`/room/delete/${o}/${D}`,{method:"POST"}),l(0,i.files[D]=null,i)):u.has(D)&&u.get(D).abort()},Y=D=>{let j=i.files[D];fetch(`/room/extend/${o}/${D}`,{method:"POST"}),j.timeLeft=re.timings.delete.newFile,l(0,i.files[D]=j,i)};return He(async D=>{if(l(1,o=location.hash.slice(1)),o==""){m();return}await Promise.all([Ke(),w()]),setInterval(w,ae.timings.refreshDelay*1e3)}),[i,o,a,c,h,t,v,x,O,Y]}class xt extends J{constructor(e){super(),K(this,e,kt,vt,X,{})}}export{xt as default};
