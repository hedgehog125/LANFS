import{S as X,i as Y,s as Z,e as _,c as b,a as k,d as c,b as u,g as v,J as h,n as U,t as B,k as P,l as j,h as S,m as z,j as ce,P as $,L as ee,T as Pe,U as ze,V as le,W as oe,f as _e,x as G,y as W,X as be,z as H,r as I,p as M,C as J,o as re,q as se,Y as Ue,Z as je,M as ve,N as Fe,_ as Le,w as Ae}from"../chunks/index-fd06faab.js";import{T as Be}from"../chunks/TopBar-0da9b611.js";let ie,ae;const Se=async r=>{ie=await(await fetch("/info")).json(),ae=ie.clientConfig};var Te="/app/immutable/assets/close-02f49dd1.svg";function ke(r,e,t){const l=r.slice();return l[6]=e[t],l[8]=t,l}function we(r){let e,t;function l(i,a){return i[2]==-1?Re:Oe}let n=l(r),o=n(r);return{c(){e=_("div"),t=_("p"),o.c(),this.h()},l(i){e=b(i,"DIV",{class:!0});var a=k(e);t=b(a,"P",{class:!0});var s=k(t);o.l(s),s.forEach(c),a.forEach(c),this.h()},h(){u(t,"class","svelte-lj1lm6"),u(e,"class","svelte-lj1lm6")},m(i,a){v(i,e,a),h(e,t),o.m(t,null)},p(i,a){n===(n=l(i))&&o?o.p(i,a):(o.d(1),o=n(i),o&&(o.c(),o.m(t,null)))},d(i){i&&c(e),o.d()}}}function Oe(r){let e,t,l,n,o,i,a=r[4],s=[];for(let f=0;f<a.length;f+=1)s[f]=xe(ke(r,a,f));return{c(){for(let f=0;f<s.length;f+=1)s[f].c();e=P(),t=_("button"),l=_("img"),this.h()},l(f){for(let d=0;d<s.length;d+=1)s[d].l(f);e=z(f),t=b(f,"BUTTON",{type:!0,title:!0,class:!0});var m=k(t);l=b(m,"IMG",{src:!0,width:!0,height:!0,alt:!0,class:!0}),m.forEach(c),this.h()},h(){$(l.src,n=Te)||u(l,"src",n),u(l,"width","24"),u(l,"height","24"),u(l,"alt","Close"),u(l,"class","svelte-lj1lm6"),u(t,"type","button"),u(t,"title","Close"),u(t,"class","svelte-lj1lm6")},m(f,m){for(let d=0;d<s.length;d+=1)s[d].m(f,m);v(f,e,m),v(f,t,m),h(t,l),o||(i=ee(t,"click",function(){Pe(r[3])&&r[3].apply(this,arguments)}),o=!0)},p(f,m){if(r=f,m&16){a=r[4];let d;for(d=0;d<a.length;d+=1){const p=ke(r,a,d);s[d]?s[d].p(p,m):(s[d]=xe(p),s[d].c(),s[d].m(e.parentNode,e))}for(;d<s.length;d+=1)s[d].d(1);s.length=a.length}},d(f){ze(s,f),f&&c(e),f&&c(t),o=!1,i()}}}function Re(r){let e,t=r[1]&&De(r);return{c(){t&&t.c(),e=j()},l(l){t&&t.l(l),e=j()},m(l,n){t&&t.m(l,n),v(l,e,n)},p(l,n){l[1]?t?t.p(l,n):(t=De(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){t&&t.d(l),l&&c(e)}}}function ye(r){let e;return{c(){e=_("br")},l(t){e=b(t,"BR",{})},m(t,l){v(t,e,l)},d(t){t&&c(e)}}}function xe(r){let e=r[6]+"",t,l,n,o=r[8]!=r[4].length-1&&ye();return{c(){t=B(e),l=P(),o&&o.c(),n=j()},l(i){t=S(i,e),l=z(i),o&&o.l(i),n=j()},m(i,a){v(i,t,a),v(i,l,a),o&&o.m(i,a),v(i,n,a)},p(i,a){a&16&&e!==(e=i[6]+"")&&ce(t,e),i[8]!=i[4].length-1?o||(o=ye(),o.c(),o.m(n.parentNode,n)):o&&(o.d(1),o=null)},d(i){i&&c(t),i&&c(l),o&&o.d(i),i&&c(n)}}}function De(r){let e;function t(o,i){return o[0]?qe:Ve}let l=t(r),n=l(r);return{c(){n.c(),e=j()},l(o){n.l(o),e=j()},m(o,i){n.m(o,i),v(o,e,i)},p(o,i){l!==(l=t(o))&&(n.d(1),n=l(o),n&&(n.c(),n.m(e.parentNode,e)))},d(o){n.d(o),o&&c(e)}}}function Ve(r){let e;return{c(){e=B("Connecting...")},l(t){e=S(t,"Connecting...")},m(t,l){v(t,e,l)},d(t){t&&c(e)}}}function qe(r){let e,t,l;return{c(){e=B("Connection error. "),t=_("br"),l=B(`
							Will continue to retry...`)},l(n){e=S(n,"Connection error. "),t=b(n,"BR",{}),l=S(n,`
							Will continue to retry...`)},m(n,o){v(n,e,o),v(n,t,o),v(n,l,o)},d(n){n&&c(e),n&&c(t),n&&c(l)}}}function Ge(r){let e,t=(r[2]!=-1||r[1])&&we(r);return{c(){e=_("main"),t&&t.c(),this.h()},l(l){e=b(l,"MAIN",{class:!0});var n=k(e);t&&t.l(n),n.forEach(c),this.h()},h(){u(e,"class","svelte-lj1lm6")},m(l,n){v(l,e,n),t&&t.m(e,null)},p(l,[n]){l[2]!=-1||l[1]?t?t.p(l,n):(t=we(l),t.c(),t.m(e,null)):t&&(t.d(1),t=null)},i:U,o:U,d(l){l&&c(e),t&&t.d()}}}function We(r,e,t){let l,{isNetworkError:n}=e,{loading:o}=e,{popupMessageCode:i}=e,{handlePopupClose:a}=e;const s=[["Oh no,","looks like that file's too big."],["That's annoying,","the upload failed due to a connection error."]];return s[99]=["Huh,","that's an unknown error."],r.$$set=f=>{"isNetworkError"in f&&t(0,n=f.isNetworkError),"loading"in f&&t(1,o=f.loading),"popupMessageCode"in f&&t(2,i=f.popupMessageCode),"handlePopupClose"in f&&t(3,a=f.handlePopupClose)},r.$$.update=()=>{r.$$.dirty&36&&t(4,l=s[i])},[n,o,i,a,l,s]}class He extends X{constructor(e){super(),Y(this,e,We,Ge,Z,{isNetworkError:0,loading:1,popupMessageCode:2,handlePopupClose:3})}}const ne={time:(r,e)=>{let t=Math.floor(r/3600);r-=t*(60*60);let l=Math.floor(r/60);r-=l*60;let o=[t,l,r];return o.splice(0,o.length-e),o.map(i=>i.toString().padStart(2,"0")).join(":")},shorten:(r,e)=>r.length<e?r:r.slice(0,e-3)+"..."};function Je(r){let e,t,l,n,o,i;return{c(){e=_("main"),t=le("svg"),l=le("circle"),n=le("circle"),i=le("circle"),this.h()},l(a){e=b(a,"MAIN",{});var s=k(e);t=oe(s,"svg",{viewBox:!0,class:!0});var f=k(t);l=oe(f,"circle",{id:!0,cx:!0,cy:!0,r:!0,class:!0}),k(l).forEach(c),n=oe(f,"circle",{id:!0,style:!0,"stroke-dasharray":!0,"stroke-width":!0,cx:!0,cy:!0,r:!0,transform:!0,class:!0}),k(n).forEach(c),i=oe(f,"circle",{id:!0,"stroke-width":!0,cx:!0,cy:!0,r:!0,class:!0}),k(i).forEach(c),f.forEach(c),s.forEach(c),this.h()},h(){u(l,"id","background"),u(l,"cx","0.5"),u(l,"cy","0.5"),u(l,"r","0.5"),u(l,"class","svelte-f8zowc"),u(n,"id","slice"),_e(n,"transition-duration",r[1]+"s"),u(n,"stroke-dasharray",o=r[0]*(Math.PI/2)+" 3.141592653589793"),u(n,"stroke-width","0.5"),u(n,"cx","0.5"),u(n,"cy","0.5"),u(n,"r","0.25"),u(n,"transform","rotate(-90) translate(-1)"),u(n,"class","svelte-f8zowc"),u(i,"id","outline"),u(i,"stroke-width",Q),u(i,"cx","0.5"),u(i,"cy","0.5"),u(i,"r","0.5"),u(i,"class","svelte-f8zowc"),u(t,"viewBox",-Q/2+" "+-Q/2+" "+(1+Q)+" "+(1+Q)),u(t,"class","svelte-f8zowc")},m(a,s){v(a,e,s),h(e,t),h(t,l),h(t,n),h(t,i)},p(a,[s]){s&2&&_e(n,"transition-duration",a[1]+"s"),s&1&&o!==(o=a[0]*(Math.PI/2)+" 3.141592653589793")&&u(n,"stroke-dasharray",o)},i:U,o:U,d(a){a&&c(e)}}}const Q=.015;function Xe(r,e,t){let{amount:l}=e,{interpolateTime:n}=e;return r.$$set=o=>{"amount"in o&&t(0,l=o.amount),"interpolateTime"in o&&t(1,n=o.interpolateTime)},[l,n]}class Ye extends X{constructor(e){super(),Y(this,e,Xe,Je,Z,{amount:0,interpolateTime:1})}}var Ze="/app/immutable/assets/download-ddd256eb.svg",Ke="/app/immutable/assets/timer-plus-0c3cdcef.svg",Qe="/app/immutable/assets/file-document-outline-8da5362f.svg";function Ee(r){let e,t,l,n,o,i,a,s,f,m,d,p;return{c(){e=_("div"),t=_("button"),l=_("img"),o=P(),i=_("a"),a=_("img"),this.h()},l(D){e=b(D,"DIV",{class:!0});var w=k(e);t=b(w,"BUTTON",{title:!0,class:!0});var N=k(t);l=b(N,"IMG",{src:!0,width:!0,height:!0,alt:!0,class:!0}),N.forEach(c),o=z(w),i=b(w,"A",{href:!0,download:!0,title:!0,class:!0});var O=k(i);a=b(O,"IMG",{src:!0,widt:!0,height:!0,alt:!0,class:!0}),O.forEach(c),w.forEach(c),this.h()},h(){$(l.src,n=Ke)||u(l,"src",n),u(l,"width","24"),u(l,"height","24"),u(l,"alt","Extend file time limit"),u(l,"class","svelte-baxtgf"),u(t,"title","Extend the time limit"),u(t,"class","svelte-baxtgf"),$(a.src,s=Ze)||u(a,"src",s),u(a,"widt","24"),u(a,"height","24"),u(a,"alt","Download the file"),u(a,"class","svelte-baxtgf"),u(i,"href",f=`/room/get/${r[0]}/${r[2]}`),u(i,"download",m=r[1].fileName),u(i,"title","Download the file"),u(i,"class","svelte-baxtgf"),u(e,"class","bottom svelte-baxtgf")},m(D,w){v(D,e,w),h(e,t),h(t,l),h(e,o),h(e,i),h(i,a),d||(p=ee(t,"click",r[5]),d=!0)},p(D,w){w&5&&f!==(f=`/room/get/${D[0]}/${D[2]}`)&&u(i,"href",f),w&2&&m!==(m=D[1].fileName)&&u(i,"download",m)},d(D){D&&c(e),d=!1,p()}}}function $e(r){let e,t,l,n,o,i,a,s,f,m,d=(r[1].ready?r[1].downloading?"Downloading...":ne.time(r[1].timeLeft,2):`${Math.floor(r[1].uploadProgress*100)}% Uploaded`)+"",p,D,w,N,O,y,C,T,F,L=ne.shorten(r[1].fileName,30)+"",R,V,te,fe,A,ue,de;s=new Ye({props:{amount:r[1].ready?r[1].timeLeft/(r[1].quickDownloadDelete?r[3].downloadedFile:r[3].newFile):r[1].uploadProgress,interpolateTime:ae.timings.refreshDelay}});let E=r[1].ready&&Ee(r);return{c(){e=_("main"),t=_("div"),l=_("img"),o=P(),i=_("div"),a=_("div"),G(s.$$.fragment),f=P(),m=_("span"),p=B(d),D=P(),w=_("button"),N=_("img"),T=P(),F=_("p"),R=B(L),V=P(),E&&E.c(),te=P(),fe=_("br"),this.h()},l(g){e=b(g,"MAIN",{class:!0});var x=k(e);t=b(x,"DIV",{class:!0});var K=k(t);l=b(K,"IMG",{src:!0,width:!0,height:!0,alt:!0,class:!0}),K.forEach(c),o=z(x),i=b(x,"DIV",{class:!0});var q=k(i);a=b(q,"DIV",{class:!0});var me=k(a);W(s.$$.fragment,me),me.forEach(c),f=z(q),m=b(q,"SPAN",{class:!0});var he=k(m);p=S(he,d),he.forEach(c),D=z(q),w=b(q,"BUTTON",{title:!0,class:!0});var ge=k(w);N=b(ge,"IMG",{src:!0,width:!0,height:!0,alt:!0,class:!0}),ge.forEach(c),q.forEach(c),T=z(x),F=b(x,"P",{class:!0});var pe=k(F);R=S(pe,L),pe.forEach(c),V=z(x),E&&E.l(x),te=z(x),fe=b(x,"BR",{}),x.forEach(c),this.h()},h(){$(l.src,n=Qe)||u(l,"src",n),u(l,"width","24"),u(l,"height","24"),u(l,"alt","A file icon"),u(l,"class","svelte-baxtgf"),u(t,"class","background svelte-baxtgf"),u(a,"class","piechart svelte-baxtgf"),u(m,"class","svelte-baxtgf"),be(m,"warning",r[1].ready&&!r[1].downloading&&r[1].timeLeft<=15),$(N.src,O=Te)||u(N,"src",O),u(N,"width","24"),u(N,"height","24"),u(N,"alt",y=r[1].ready?"Delete the file":"Cancel upload"),u(N,"class","svelte-baxtgf"),u(w,"title",C=r[1].ready?"Delete the file":"Cancel upload"),u(w,"class","svelte-baxtgf"),u(i,"class","top svelte-baxtgf"),u(F,"class","title svelte-baxtgf"),u(e,"class","svelte-baxtgf")},m(g,x){v(g,e,x),h(e,t),h(t,l),h(e,o),h(e,i),h(i,a),H(s,a,null),h(i,f),h(i,m),h(m,p),h(i,D),h(i,w),h(w,N),h(e,T),h(e,F),h(F,R),h(e,V),E&&E.m(e,null),h(e,te),h(e,fe),A=!0,ue||(de=ee(w,"click",r[4]),ue=!0)},p(g,[x]){const K={};x&2&&(K.amount=g[1].ready?g[1].timeLeft/(g[1].quickDownloadDelete?g[3].downloadedFile:g[3].newFile):g[1].uploadProgress),s.$set(K),(!A||x&2)&&d!==(d=(g[1].ready?g[1].downloading?"Downloading...":ne.time(g[1].timeLeft,2):`${Math.floor(g[1].uploadProgress*100)}% Uploaded`)+"")&&ce(p,d),x&2&&be(m,"warning",g[1].ready&&!g[1].downloading&&g[1].timeLeft<=15),(!A||x&2&&y!==(y=g[1].ready?"Delete the file":"Cancel upload"))&&u(N,"alt",y),(!A||x&2&&C!==(C=g[1].ready?"Delete the file":"Cancel upload"))&&u(w,"title",C),(!A||x&2)&&L!==(L=ne.shorten(g[1].fileName,30)+"")&&ce(R,L),g[1].ready?E?E.p(g,x):(E=Ee(g),E.c(),E.m(e,te)):E&&(E.d(1),E=null)},i(g){A||(I(s.$$.fragment,g),A=!0)},o(g){M(s.$$.fragment,g),A=!1},d(g){g&&c(e),J(s),E&&E.d(),ue=!1,de()}}}function et(r,e,t){const l=ie.timings.delete;let{roomName:n}=e,{file:o}=e,{fileID:i}=e,{index:a}=e,{handleDelete:s}=e,{handleExtend:f}=e;const m=p=>{s(i)},d=p=>{f(i)};return r.$$set=p=>{"roomName"in p&&t(0,n=p.roomName),"file"in p&&t(1,o=p.file),"fileID"in p&&t(6,i=p.fileID),"index"in p&&t(2,a=p.index),"handleDelete"in p&&t(7,s=p.handleDelete),"handleExtend"in p&&t(8,f=p.handleExtend)},[n,o,a,l,m,d,i,s,f]}class tt extends X{constructor(e){super(),Y(this,e,et,$e,Z,{roomName:0,file:1,fileID:6,index:2,handleDelete:7,handleExtend:8})}}function Ne(r,e,t){const l=r.slice();return l[4]=e[t],l[6]=t,l}function lt(r){let e=[],t=new Map,l,n,o=r[1].files;const i=a=>a[6];for(let a=0;a<o.length;a+=1){let s=Ne(r,o,a),f=i(s);t.set(f,e[a]=Ce(f,s))}return{c(){for(let a=0;a<e.length;a+=1)e[a].c();l=j()},l(a){for(let s=0;s<e.length;s+=1)e[s].l(a);l=j()},m(a,s){for(let f=0;f<e.length;f+=1)e[f].m(a,s);v(a,l,s),n=!0},p(a,s){s&15&&(o=a[1].files,re(),e=Ue(e,s,i,1,a,o,t,l.parentNode,je,Ce,l,Ne),se())},i(a){if(!n){for(let s=0;s<o.length;s+=1)I(e[s]);n=!0}},o(a){for(let s=0;s<e.length;s+=1)M(e[s]);n=!1},d(a){for(let s=0;s<e.length;s+=1)e[s].d(a);a&&c(l)}}}function ot(r){let e,t,l,n;return{c(){e=_("p"),t=B("Looks like there aren't any files here yet. "),l=_("br"),n=B(`
            Try uploading one by dropping it here or by clicking the upload button.`),this.h()},l(o){e=b(o,"P",{class:!0});var i=k(e);t=S(i,"Looks like there aren't any files here yet. "),l=b(i,"BR",{}),n=S(i,`
            Try uploading one by dropping it here or by clicking the upload button.`),i.forEach(c),this.h()},h(){u(e,"class","bold svelte-13gsupi")},m(o,i){v(o,e,i),h(e,t),h(e,l),h(e,n)},p:U,i:U,o:U,d(o){o&&c(e)}}}function Ie(r){let e,t;return e=new tt({props:{roomName:r[0],file:r[4],fileID:r[6],index:r[6],handleDelete:r[2],handleExtend:r[3]}}),{c(){G(e.$$.fragment)},l(l){W(e.$$.fragment,l)},m(l,n){H(e,l,n),t=!0},p(l,n){const o={};n&1&&(o.roomName=l[0]),n&2&&(o.file=l[4]),n&2&&(o.fileID=l[6]),n&2&&(o.index=l[6]),n&4&&(o.handleDelete=l[2]),n&8&&(o.handleExtend=l[3]),e.$set(o)},i(l){t||(I(e.$$.fragment,l),t=!0)},o(l){M(e.$$.fragment,l),t=!1},d(l){J(e,l)}}}function Ce(r,e){let t,l,n,o=e[4]!=null&&Ie(e);return{key:r,first:null,c(){t=j(),o&&o.c(),l=j(),this.h()},l(i){t=j(),o&&o.l(i),l=j(),this.h()},h(){this.first=t},m(i,a){v(i,t,a),o&&o.m(i,a),v(i,l,a),n=!0},p(i,a){e=i,e[4]!=null?o?(o.p(e,a),a&2&&I(o,1)):(o=Ie(e),o.c(),I(o,1),o.m(l.parentNode,l)):o&&(re(),M(o,1,1,()=>{o=null}),se())},i(i){n||(I(o),n=!0)},o(i){M(o),n=!1},d(i){i&&c(t),o&&o.d(i),i&&c(l)}}}function nt(r){let e,t,l,n;const o=[ot,lt],i=[];function a(s,f){return s[1].files.length==0?0:1}return t=a(r),l=i[t]=o[t](r),{c(){e=_("main"),l.c()},l(s){e=b(s,"MAIN",{});var f=k(e);l.l(f),f.forEach(c)},m(s,f){v(s,e,f),i[t].m(e,null),n=!0},p(s,[f]){let m=t;t=a(s),t===m?i[t].p(s,f):(re(),M(i[m],1,1,()=>{i[m]=null}),se(),l=i[t],l?l.p(s,f):(l=i[t]=o[t](s),l.c()),I(l,1),l.m(e,null))},i(s){n||(I(l),n=!0)},o(s){M(l),n=!1},d(s){s&&c(e),i[t].d()}}}function it(r,e,t){let{roomName:l}=e,{roomData:n}=e,{handleDelete:o}=e,{handleExtend:i}=e;return r.$$set=a=>{"roomName"in a&&t(0,l=a.roomName),"roomData"in a&&t(1,n=a.roomData),"handleDelete"in a&&t(2,o=a.handleDelete),"handleExtend"in a&&t(3,i=a.handleExtend)},[l,n,o,i]}class at extends X{constructor(e){super(),Y(this,e,it,nt,Z,{roomName:0,roomData:1,handleDelete:2,handleExtend:3})}}function rt(r){let e,t;return{c:U,l:U,m(l,n){e||(t=[ee(window,"dragover",ve(r[2])),ee(window,"drop",ve(r[0]))],e=!0)},p:U,i:U,o:U,d(l){e=!1,Fe(t)}}}function st(r,e,t){let{handleUpload:l}=e;const n=i=>{let a=i.dataTransfer.items;if(a){let s=[];for(let f of a)f.kind=="file"&&s.push(f.getAsFile());s.length!=0&&l(s)}};function o(i){Le.call(this,r,i)}return r.$$set=i=>{"handleUpload"in i&&t(1,l=i.handleUpload)},[n,l,o]}class ft extends X{constructor(e){super(),Y(this,e,st,rt,Z,{handleUpload:1})}}function Me(r){let e,t,l,n;return e=new at({props:{roomName:r[1],roomData:r[0],handleDelete:r[7],handleExtend:r[8]}}),l=new ft({props:{handleUpload:r[5]}}),{c(){G(e.$$.fragment),t=P(),G(l.$$.fragment)},l(o){W(e.$$.fragment,o),t=z(o),W(l.$$.fragment,o)},m(o,i){H(e,o,i),v(o,t,i),H(l,o,i),n=!0},p(o,i){const a={};i&2&&(a.roomName=o[1]),i&1&&(a.roomData=o[0]),e.$set(a)},i(o){n||(I(e.$$.fragment,o),I(l.$$.fragment,o),n=!0)},o(o){M(e.$$.fragment,o),M(l.$$.fragment,o),n=!1},d(o){J(e,o),o&&c(t),J(l,o)}}}function ut(r){let e,t,l,n,o,i;t=new Be({props:{handleUpload:r[5]}}),n=new He({props:{isNetworkError:r[3],loading:r[2],popupMessageCode:r[4],handlePopupClose:r[6]}});let a=!r[2]&&Me(r);return{c(){e=_("main"),G(t.$$.fragment),l=P(),G(n.$$.fragment),o=P(),a&&a.c()},l(s){e=b(s,"MAIN",{});var f=k(e);W(t.$$.fragment,f),l=z(f),W(n.$$.fragment,f),o=z(f),a&&a.l(f),f.forEach(c)},m(s,f){v(s,e,f),H(t,e,null),h(e,l),H(n,e,null),h(e,o),a&&a.m(e,null),i=!0},p(s,[f]){const m={};f&8&&(m.isNetworkError=s[3]),f&4&&(m.loading=s[2]),f&16&&(m.popupMessageCode=s[4]),n.$set(m),s[2]?a&&(re(),M(a,1,1,()=>{a=null}),se()):a?(a.p(s,f),f&4&&I(a,1)):(a=Me(s),a.c(),I(a,1),a.m(e,null))},i(s){i||(I(t.$$.fragment,s),I(n.$$.fragment,s),I(a),i=!0)},o(s){M(t.$$.fragment,s),M(n.$$.fragment,s),M(a),i=!1},d(s){s&&c(e),J(t),J(n),a&&a.d()}}}function ct(r,e,t){let n,o,i=!0,a,s=!1;const f=async y=>{let C=Date.now();try{let T=await fetch(`/room/get/${o}`);T.ok?t(0,n=await T.json()):(t(0,n=null),t(3,s=!1))}catch{t(0,n=null),t(3,s=!0)}n?i&&(a=setTimeout(T=>{t(2,i=!1)},750-(Date.now()-C))):(t(2,i=!0),a!=null&&clearTimeout(a))},m=y=>{location.href="/"};let d=new Map;const p=y=>{let C=!1;for(let T of y){if(T.size>ae.max.fileSize){C=!0;continue}let F=n.files.length,L=new FormData;L.set("upload",T);let R=new AbortController;fetch(`/room/upload/${o}`,{method:"POST",body:L,signal:R.signal}).then(V=>{d.delete(F)}).catch(V=>{d.delete(F),V.name!="AbortSignal"&&t(4,D=1)}),d.set(F,R),t(0,n.files[F]={fileName:T.name,timeLeft:0,ready:!1,uploadProgress:0,size:T.size},n)}C&&t(4,D=0)};let D=-1;const w=y=>{t(4,D=-1)},N=y=>{n.files[y].ready?(fetch(`/room/delete/${o}/${y}`,{method:"POST"}),t(0,n.files[y]=null,n)):d.has(y)&&d.get(y).abort()},O=y=>{let C=n.files[y];fetch(`/room/extend/${o}/${y}`,{method:"POST"}),C.timeLeft=ie.timings.delete.newFile,t(0,n.files[y]=C,n)};return Ae(async y=>{if(t(1,o=location.hash.slice(1)),o==""){m();return}await Promise.all([Se(),f()]),setInterval(f,ae.timings.refreshDelay*1e3)}),[n,o,i,s,D,p,w,N,O]}class ht extends X{constructor(e){super(),Y(this,e,ct,ut,Z,{})}}export{ht as default};
