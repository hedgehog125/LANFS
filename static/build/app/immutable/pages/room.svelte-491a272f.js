import{S as U,i as F,s as B,e as E,c as M,a as b,d as _,b as m,g as v,J as w,n as T,t as q,h as O,R,T as $,w as te,x as I,y as P,z as D,r as k,p as N,C as z,k as W,m as V,L as J,j as le,o as Y,q as H,l as j,U as ne,V as re,M as G,N as oe,W as ae}from"../chunks/index-c080b2ec.js";import{T as ie}from"../chunks/TopBar-b49133dd.js";function se(s){let e;return{c(){e=q("Connecting...")},l(t){e=O(t,"Connecting...")},m(t,l){v(t,e,l)},d(t){t&&_(e)}}}function fe(s){let e,t,l;return{c(){e=q("Connection error. "),t=E("br"),l=q(`\r
				Will continue to retry...`)},l(r){e=O(r,"Connection error. "),t=M(r,"BR",{}),l=O(r,`\r
				Will continue to retry...`)},m(r,n){v(r,e,n),v(r,t,n),v(r,l,n)},d(r){r&&_(e),r&&_(t),r&&_(l)}}}function ce(s){let e,t,l;function r(i,a){return i[0]?fe:se}let n=r(s),o=n(s);return{c(){e=E("main"),t=E("div"),l=E("p"),o.c(),this.h()},l(i){e=M(i,"MAIN",{});var a=b(e);t=M(a,"DIV",{class:!0});var f=b(t);l=M(f,"P",{class:!0});var c=b(l);o.l(c),c.forEach(_),f.forEach(_),a.forEach(_),this.h()},h(){m(l,"class","svelte-ma1ccf"),m(t,"class","svelte-ma1ccf")},m(i,a){v(i,e,a),w(e,t),w(t,l),o.m(l,null)},p(i,[a]){n!==(n=r(i))&&(o.d(1),o=n(i),o&&(o.c(),o.m(l,null)))},i:T,o:T,d(i){i&&_(e),o.d()}}}function ue(s,e,t){let{isNetworkError:l}=e;return s.$$set=r=>{"isNetworkError"in r&&t(0,l=r.isNetworkError)},[l]}class me extends U{constructor(e){super(),F(this,e,ue,ce,B,{isNetworkError:0})}}function de(s){let e,t,l,r,n,o,i,a;return{c(){e=E("main"),t=R("svg"),l=R("circle"),r=R("path"),o=R("path"),a=R("circle"),this.h()},l(f){e=M(f,"MAIN",{});var c=b(e);t=$(c,"svg",{viewBox:!0,width:!0,height:!0,class:!0});var u=b(t);l=$(u,"circle",{fill:!0,cx:!0,cy:!0,r:!0}),b(l).forEach(_),r=$(u,"path",{fill:!0,d:!0,class:!0}),b(r).forEach(_),o=$(u,"path",{fill:!0,d:!0,class:!0}),b(o).forEach(_),a=$(u,"circle",{fill:!0,stroke:!0,"stroke-width":!0,cx:!0,cy:!0,r:!0}),b(a).forEach(_),u.forEach(_),c.forEach(_),this.h()},h(){m(l,"fill",_e),m(l,"cx","0.5"),m(l,"cy","0.5"),m(l,"r",s[2]),m(r,"fill",K),m(r,"d",n="M0.5,0.5 L0.5,"+A+" A"+s[2]+","+s[2]+" 1 0,1 "+s[0][0]+","+s[1][0]+" z"),m(r,"class","svelte-kbmd8d"),m(o,"fill",K),m(o,"d",i="M0.5,0.5 L0.5,"+(1-A)+" A"+s[2]+","+s[2]+" 1 0,1 "+s[0][1]+","+s[1][1]+" z"),m(o,"class","svelte-kbmd8d"),m(a,"fill","none"),m(a,"stroke",he),m(a,"stroke-width",A),m(a,"cx","0.5"),m(a,"cy","0.5"),m(a,"r",s[2]),m(t,"viewBox","0 0 1 1"),m(t,"width","500"),m(t,"height","500"),m(t,"class","svelte-kbmd8d")},m(f,c){v(f,e,c),w(e,t),w(t,l),w(t,r),w(t,o),w(t,a)},p(f,[c]){c&3&&n!==(n="M0.5,0.5 L0.5,"+A+" A"+f[2]+","+f[2]+" 1 0,1 "+f[0][0]+","+f[1][0]+" z")&&m(r,"d",n),c&3&&i!==(i="M0.5,0.5 L0.5,"+(1-A)+" A"+f[2]+","+f[2]+" 1 0,1 "+f[0][1]+","+f[1][1]+" z")&&m(o,"d",i)},i:T,o:T,d(f){f&&_(e)}}}const A=.005,K="darkgrey",_e="lightgrey",he="black";function pe(s,e,t){let{amount:l}=e,{interpolateTime:r}=e,n=l,o,i;const a=.5-A,f=2+A*3;let[c,u]=[[],[]];const C=p=>{let y=.5+Math.sin(p*(Math.PI*2))/f,L=.5-Math.cos(p*(Math.PI*2))/f,S=p>.5,X=1-A/2;t(0,c[0]=S?.5:y,c),t(1,u[0]=S?X:L,u),t(0,c[1]=S?y:.5,c),t(1,u[1]=S?L:X,u)};let d,g;const h=p=>{if(g==null)t(5,n=l);else{let y=p-g;i!=l&&(console.log(l),o=(l-i)/r/1e3,i=l),Math.abs(n-l)>.01&&t(5,n+=o*y)}g=p,d=requestAnimationFrame(h)};return te(p=>(h(),y=>{cancelAnimationFrame(d)})),s.$$set=p=>{"amount"in p&&t(3,l=p.amount),"interpolateTime"in p&&t(4,r=p.interpolateTime)},s.$$.update=()=>{s.$$.dirty&32&&C(n)},[c,u,a,l,r,n]}class ge extends U{constructor(e){super(),F(this,e,pe,de,B,{amount:3,interpolateTime:4})}}function Q(s){let e,t;return e=new ge({props:{amount:s[1].uploadProgress,interpolateTime:"1"}}),{c(){I(e.$$.fragment)},l(l){P(e.$$.fragment,l)},m(l,r){D(e,l,r),t=!0},p(l,r){const n={};r&2&&(n.amount=l[1].uploadProgress),e.$set(n)},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){N(e.$$.fragment,l),t=!1},d(l){z(e,l)}}}function ke(s){let e,t,l=s[1].fileName+"",r,n,o,i,a,f,c,u,C,d=!s[1].ready&&Q(s);return{c(){e=E("main"),t=E("a"),r=q(l),i=W(),d&&d.c(),a=W(),f=E("br"),this.h()},l(g){e=M(g,"MAIN",{});var h=b(e);t=M(h,"A",{href:!0,download:!0});var p=b(t);r=O(p,l),p.forEach(_),i=V(h),d&&d.l(h),a=V(h),f=M(h,"BR",{}),h.forEach(_),this.h()},h(){m(t,"href",n=`/room/get/${s[0]}/${s[2]}`),m(t,"download",o=s[1].fileName)},m(g,h){v(g,e,h),w(e,t),w(t,r),w(e,i),d&&d.m(e,null),w(e,a),w(e,f),c=!0,u||(C=J(t,"click",s[4]),u=!0)},p(g,[h]){(!c||h&2)&&l!==(l=g[1].fileName+"")&&le(r,l),(!c||h&5&&n!==(n=`/room/get/${g[0]}/${g[2]}`))&&m(t,"href",n),(!c||h&2&&o!==(o=g[1].fileName))&&m(t,"download",o),g[1].ready?d&&(Y(),N(d,1,1,()=>{d=null}),H()):d?(d.p(g,h),h&2&&k(d,1)):(d=Q(g),d.c(),k(d,1),d.m(e,a))},i(g){c||(k(d),c=!0)},o(g){N(d),c=!1},d(g){g&&_(e),d&&d.d(),u=!1,C()}}}function be(s,e,t){let{roomName:l}=e,{file:r}=e,{index:n}=e,{handleClick:o}=e;const i=a=>o(a,r);return s.$$set=a=>{"roomName"in a&&t(0,l=a.roomName),"file"in a&&t(1,r=a.file),"index"in a&&t(2,n=a.index),"handleClick"in a&&t(3,o=a.handleClick)},[l,r,n,o,i]}class we extends U{constructor(e){super(),F(this,e,be,ke,B,{roomName:0,file:1,index:2,handleClick:3})}}function Z(s,e,t){const l=s.slice();return l[3]=e[t],l[5]=t,l}function x(s){let e,t;return e=new we({props:{roomName:s[0],file:s[3],index:s[5],handleClick:s[2]}}),{c(){I(e.$$.fragment)},l(l){P(e.$$.fragment,l)},m(l,r){D(e,l,r),t=!0},p(l,r){const n={};r&1&&(n.roomName=l[0]),r&2&&(n.file=l[3]),r&2&&(n.index=l[5]),e.$set(n)},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){N(e.$$.fragment,l),t=!1},d(l){z(e,l)}}}function ee(s,e){let t,l,r,n=e[3]!=null&&x(e);return{key:s,first:null,c(){t=j(),n&&n.c(),l=j(),this.h()},l(o){t=j(),n&&n.l(o),l=j(),this.h()},h(){this.first=t},m(o,i){v(o,t,i),n&&n.m(o,i),v(o,l,i),r=!0},p(o,i){e=o,e[3]!=null?n?(n.p(e,i),i&2&&k(n,1)):(n=x(e),n.c(),k(n,1),n.m(l.parentNode,l)):n&&(Y(),N(n,1,1,()=>{n=null}),H())},i(o){r||(k(n),r=!0)},o(o){N(n),r=!1},d(o){o&&_(t),n&&n.d(o),o&&_(l)}}}function Ne(s){let e,t=[],l=new Map,r,n=s[1].files;const o=i=>i[5];for(let i=0;i<n.length;i+=1){let a=Z(s,n,i),f=o(a);l.set(f,t[i]=ee(f,a))}return{c(){e=E("main");for(let i=0;i<t.length;i+=1)t[i].c()},l(i){e=M(i,"MAIN",{});var a=b(e);for(let f=0;f<t.length;f+=1)t[f].l(a);a.forEach(_)},m(i,a){v(i,e,a);for(let f=0;f<t.length;f+=1)t[f].m(e,null);r=!0},p(i,[a]){a&7&&(n=i[1].files,Y(),t=ne(t,a,o,1,i,n,l,e,re,ee,null,Z),H())},i(i){if(!r){for(let a=0;a<n.length;a+=1)k(t[a]);r=!0}},o(i){for(let a=0;a<t.length;a+=1)N(t[a]);r=!1},d(i){i&&_(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}function ve(s,e,t){let{roomName:l}=e,{roomData:r}=e;const n=(o,i)=>{i.ready||o.preventDefault()};return s.$$set=o=>{"roomName"in o&&t(0,l=o.roomName),"roomData"in o&&t(1,r=o.roomData)},[l,r,n]}class ye extends U{constructor(e){super(),F(this,e,ve,Ne,B,{roomName:0,roomData:1})}}function Ce(s){let e,t;return{c:T,l:T,m(l,r){e||(t=[J(window,"dragover",G(s[2])),J(window,"drop",G(s[0]))],e=!0)},p:T,i:T,o:T,d(l){e=!1,oe(t)}}}function Ee(s,e,t){let{onUpload:l}=e;const r=o=>{let i=o.dataTransfer.items;if(i){let a=[];for(let f of i)f.kind=="file"&&a.push(f.getAsFile());a.length!=0&&l(a)}};function n(o){ae.call(this,s,o)}return s.$$set=o=>{"onUpload"in o&&t(1,l=o.onUpload)},[r,l,n]}class Me extends U{constructor(e){super(),F(this,e,Ee,Ce,B,{onUpload:1})}}function Te(s){let e,t,l,r;return e=new ye({props:{roomName:s[1],roomData:s[0]}}),l=new Me({props:{onUpload:s[4]}}),{c(){I(e.$$.fragment),t=W(),I(l.$$.fragment)},l(n){P(e.$$.fragment,n),t=V(n),P(l.$$.fragment,n)},m(n,o){D(e,n,o),v(n,t,o),D(l,n,o),r=!0},p(n,o){const i={};o&2&&(i.roomName=n[1]),o&1&&(i.roomData=n[0]),e.$set(i)},i(n){r||(k(e.$$.fragment,n),k(l.$$.fragment,n),r=!0)},o(n){N(e.$$.fragment,n),N(l.$$.fragment,n),r=!1},d(n){z(e,n),n&&_(t),z(l,n)}}}function Ae(s){let e,t;return e=new me({props:{isNetworkError:s[3]}}),{c(){I(e.$$.fragment)},l(l){P(e.$$.fragment,l)},m(l,r){D(e,l,r),t=!0},p(l,r){const n={};r&8&&(n.isNetworkError=l[3]),e.$set(n)},i(l){t||(k(e.$$.fragment,l),t=!0)},o(l){N(e.$$.fragment,l),t=!1},d(l){z(e,l)}}}function Ie(s){let e,t,l,r,n,o;t=new ie({});const i=[Ae,Te],a=[];function f(c,u){return c[2]?0:1}return r=f(s),n=a[r]=i[r](s),{c(){e=E("main"),I(t.$$.fragment),l=W(),n.c()},l(c){e=M(c,"MAIN",{});var u=b(e);P(t.$$.fragment,u),l=V(u),n.l(u),u.forEach(_)},m(c,u){v(c,e,u),D(t,e,null),w(e,l),a[r].m(e,null),o=!0},p(c,[u]){let C=r;r=f(c),r===C?a[r].p(c,u):(Y(),N(a[C],1,1,()=>{a[C]=null}),H(),n=a[r],n?n.p(c,u):(n=a[r]=i[r](c),n.c()),k(n,1),n.m(e,null))},i(c){o||(k(t.$$.fragment,c),k(n),o=!0)},o(c){N(t.$$.fragment,c),N(n),o=!1},d(c){c&&_(e),z(t),a[r].d()}}}function Pe(s,e,t){let r,n,o,i,a=!0,f,c=!1;const u=async h=>{let p;try{p=await fetch(`/room/get/${i}`),p.ok?t(0,o=await p.json()):(t(0,o=null),t(3,c=!1))}catch{t(0,o=null),t(3,c=!0)}o?f=setTimeout(y=>{t(2,a=!1)},750):(t(2,a=!0),f!=null&&clearTimeout(f))},C=async h=>{n=await(await fetch("/info")).json(),r=n.clientConfig},d=h=>{location.href="/"},g=h=>{let p=!1;for(let y of h){if(y.size>r.max.fileSize){p=!0;continue}let L=new FormData;L.set("upload",y),fetch(`room/upload/${i}`,{method:"POST",body:L}),t(0,o.files[o.files.length]={fileName:y.name,timeLeft:0,ready:!1,uploadProgress:0,size:y.size},o)}if(p)debugger};return te(async h=>{if(t(1,i=location.hash.slice(1)),i==""){d();return}u(),await C(),setInterval(u,r.timings.refreshDelay*1e3)}),[o,i,a,c,g]}class Ue extends U{constructor(e){super(),F(this,e,Pe,Ie,B,{})}}export{Ue as default};
