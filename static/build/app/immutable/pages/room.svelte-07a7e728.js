import{S as q,i as O,s as G,e as _,c as h,a as b,d as m,b as c,g as j,J as d,n as D,t as x,h as z,R as K,T as Q,f as de,k as T,m as M,P as Z,x as B,y as R,U as ge,z as S,j as pe,r as N,p as E,C as V,o as te,q as le,l as A,V as ye,W as je,L as _e,M as he,N as Ne,X as Ee,w as $e}from"../chunks/index-00bb9875.js";import{T as De}from"../chunks/TopBar-63190aca.js";let ne,ee;const Ie=async a=>{ne=await(await fetch("/info")).json(),ee=ne.clientConfig},Te=async(...a)=>{let e=[];for(let l of a)e.push(l());for(let l of e)await l},Y={time:(a,e)=>{let l=Math.floor(a/3600);a-=l*(60*60);let t=Math.floor(a/60);a-=t*60;let o=[l,t,a];return o.splice(0,o.length-e),o.map(s=>s.toString().padStart(2,"0")).join(":")},shorten:(a,e)=>a.length<e?a:a.slice(0,e-3)+"..."};function Me(a){let e;return{c(){e=x("Connecting...")},l(l){e=z(l,"Connecting...")},m(l,t){j(l,e,t)},d(l){l&&m(e)}}}function Pe(a){let e,l,t;return{c(){e=x("Connection error. "),l=_("br"),t=x(`
				Will continue to retry...`)},l(r){e=z(r,"Connection error. "),l=h(r,"BR",{}),t=z(r,`
				Will continue to retry...`)},m(r,o){j(r,e,o),j(r,l,o),j(r,t,o)},d(r){r&&m(e),r&&m(l),r&&m(t)}}}function Ce(a){let e,l,t;function r(n,i){return n[0]?Pe:Me}let o=r(a),s=o(a);return{c(){e=_("main"),l=_("div"),t=_("p"),s.c(),this.h()},l(n){e=h(n,"MAIN",{});var i=b(e);l=h(i,"DIV",{class:!0});var f=b(l);t=h(f,"P",{class:!0});var u=b(t);s.l(u),u.forEach(m),f.forEach(m),i.forEach(m),this.h()},h(){c(t,"class","svelte-ma1ccf"),c(l,"class","svelte-ma1ccf")},m(n,i){j(n,e,i),d(e,l),d(l,t),s.m(t,null)},p(n,[i]){o!==(o=r(n))&&(s.d(1),s=o(n),s&&(s.c(),s.m(t,null)))},i:D,o:D,d(n){n&&m(e),s.d()}}}function xe(a,e,l){let{isNetworkError:t}=e;return a.$$set=r=>{"isNetworkError"in r&&l(0,t=r.isNetworkError)},[t]}class ze extends q{constructor(e){super(),O(this,e,xe,Ce,G,{isNetworkError:0})}}function Ue(a){let e,l,t,r,o,s;return{c(){e=_("main"),l=K("svg"),t=K("circle"),r=K("circle"),s=K("circle"),this.h()},l(n){e=h(n,"MAIN",{});var i=b(e);l=Q(i,"svg",{viewBox:!0,class:!0});var f=b(l);t=Q(f,"circle",{id:!0,cx:!0,cy:!0,r:!0,class:!0}),b(t).forEach(m),r=Q(f,"circle",{id:!0,style:!0,"stroke-dasharray":!0,"stroke-width":!0,cx:!0,cy:!0,r:!0,transform:!0,class:!0}),b(r).forEach(m),s=Q(f,"circle",{id:!0,"stroke-width":!0,cx:!0,cy:!0,r:!0,class:!0}),b(s).forEach(m),f.forEach(m),i.forEach(m),this.h()},h(){c(t,"id","background"),c(t,"cx","0.5"),c(t,"cy","0.5"),c(t,"r","0.5"),c(t,"class","svelte-f8zowc"),c(r,"id","slice"),de(r,"transition-duration",a[1]+"s"),c(r,"stroke-dasharray",o=a[0]*(Math.PI/2)+" 3.141592653589793"),c(r,"stroke-width","0.5"),c(r,"cx","0.5"),c(r,"cy","0.5"),c(r,"r","0.25"),c(r,"transform","rotate(-90) translate(-1)"),c(r,"class","svelte-f8zowc"),c(s,"id","outline"),c(s,"stroke-width",J),c(s,"cx","0.5"),c(s,"cy","0.5"),c(s,"r","0.5"),c(s,"class","svelte-f8zowc"),c(l,"viewBox",-J/2+" "+-J/2+" "+(1+J)+" "+(1+J)),c(l,"class","svelte-f8zowc")},m(n,i){j(n,e,i),d(e,l),d(l,t),d(l,r),d(l,s)},p(n,[i]){i&2&&de(r,"transition-duration",n[1]+"s"),i&1&&o!==(o=n[0]*(Math.PI/2)+" 3.141592653589793")&&c(r,"stroke-dasharray",o)},i:D,o:D,d(n){n&&m(e)}}}const J=.015;function Fe(a,e,l){let{amount:t}=e,{interpolateTime:r}=e;return a.$$set=o=>{"amount"in o&&l(0,t=o.amount),"interpolateTime"in o&&l(1,r=o.interpolateTime)},[t,r]}class Le extends q{constructor(e){super(),O(this,e,Fe,Ue,G,{amount:0,interpolateTime:1})}}var Ae="/app/immutable/assets/download-ddd256eb.svg",Be="/app/immutable/assets/close-02f49dd1.svg",Re="/app/immutable/assets/timer-plus-0c3cdcef.svg",Se="/app/immutable/assets/file-document-outline-8da5362f.svg";function ve(a){let e,l,t,r,o,s,n,i,f,u;return{c(){e=_("div"),l=_("button"),t=_("img"),o=T(),s=_("a"),n=_("img"),this.h()},l(g){e=h(g,"DIV",{class:!0});var v=b(e);l=h(v,"BUTTON",{title:!0,class:!0});var $=b(l);t=h($,"IMG",{src:!0,alt:!0,class:!0}),$.forEach(m),o=M(v),s=h(v,"A",{href:!0,download:!0,title:!0,class:!0});var w=b(s);n=h(w,"IMG",{src:!0,alt:!0,class:!0}),w.forEach(m),v.forEach(m),this.h()},h(){Z(t.src,r=Re)||c(t,"src",r),c(t,"alt","Extend file time limit"),c(t,"class","svelte-mfcj0g"),c(l,"title","Extend file time limit"),c(l,"class","svelte-mfcj0g"),Z(n.src,i=Ae)||c(n,"src",i),c(n,"alt","Download the file"),c(n,"class","svelte-mfcj0g"),c(s,"href",f=`/room/get/${a[0]}/${a[2]}`),c(s,"download",u=a[1].fileName),c(s,"title","Download the file"),c(s,"class","svelte-mfcj0g"),c(e,"class","bottom svelte-mfcj0g")},m(g,v){j(g,e,v),d(e,l),d(l,t),d(e,o),d(e,s),d(s,n)},p(g,v){v&5&&f!==(f=`/room/get/${g[0]}/${g[2]}`)&&c(s,"href",f),v&2&&u!==(u=g[1].fileName)&&c(s,"download",u)},d(g){g&&m(e)}}}function Ve(a){let e,l,t,r,o,s,n=(a[1].ready?Y.time(a[1].timeLeft,2):`${Math.floor(a[1].uploadProgress*100)}% Uploaded`)+"",i,f,u,g,v,$,w,U,F,W=Y.shorten(a[1].fileName,30)+"",X,oe,L,C,ae,re,H,se,P;r=new Le({props:{amount:a[1].ready?a[1].timeLeft/(a[1].quickDownloadDelete?a[3].downloadedFile:a[3].newFile):a[1].uploadProgress,interpolateTime:ee.timings.refreshDelay}});let y=a[1].ready&&ve(a);return{c(){e=_("main"),l=_("div"),t=_("div"),B(r.$$.fragment),o=T(),s=_("span"),i=x(n),f=T(),u=_("button"),g=_("img"),U=T(),F=_("p"),X=x(W),oe=T(),L=_("div"),C=_("img"),re=T(),y&&y.c(),H=T(),se=_("br"),this.h()},l(p){e=h(p,"MAIN",{class:!0});var k=b(e);l=h(k,"DIV",{class:!0});var I=b(l);t=h(I,"DIV",{class:!0});var ie=b(t);R(r.$$.fragment,ie),ie.forEach(m),o=M(I),s=h(I,"SPAN",{class:!0});var ce=b(s);i=z(ce,n),ce.forEach(m),f=M(I),u=h(I,"BUTTON",{title:!0,class:!0});var fe=b(u);g=h(fe,"IMG",{src:!0,alt:!0,class:!0}),fe.forEach(m),I.forEach(m),U=M(k),F=h(k,"P",{class:!0});var ue=b(F);X=z(ue,W),ue.forEach(m),oe=M(k),L=h(k,"DIV",{class:!0});var me=b(L);C=h(me,"IMG",{src:!0,alt:!0,class:!0}),me.forEach(m),re=M(k),y&&y.l(k),H=M(k),se=h(k,"BR",{}),k.forEach(m),this.h()},h(){c(t,"class","piechart svelte-mfcj0g"),c(s,"class","svelte-mfcj0g"),ge(s,"warning",a[1].ready&&a[1].timeLeft<=15),Z(g.src,v=Be)||c(g,"src",v),c(g,"alt",$=a[1].ready?"Delete file":"Cancel upload"),c(g,"class","svelte-mfcj0g"),c(u,"title",w=a[1].ready?"Delete file":"Cancel upload"),c(u,"class","svelte-mfcj0g"),c(l,"class","top svelte-mfcj0g"),c(F,"class","title svelte-mfcj0g"),Z(C.src,ae=Se)||c(C,"src",ae),c(C,"alt","A file icon"),c(C,"class","svelte-mfcj0g"),c(L,"class","background svelte-mfcj0g"),c(e,"class","svelte-mfcj0g")},m(p,k){j(p,e,k),d(e,l),d(l,t),S(r,t,null),d(l,o),d(l,s),d(s,i),d(l,f),d(l,u),d(u,g),d(e,U),d(e,F),d(F,X),d(e,oe),d(e,L),d(L,C),d(e,re),y&&y.m(e,null),d(e,H),d(e,se),P=!0},p(p,[k]){const I={};k&2&&(I.amount=p[1].ready?p[1].timeLeft/(p[1].quickDownloadDelete?p[3].downloadedFile:p[3].newFile):p[1].uploadProgress),r.$set(I),(!P||k&2)&&n!==(n=(p[1].ready?Y.time(p[1].timeLeft,2):`${Math.floor(p[1].uploadProgress*100)}% Uploaded`)+"")&&pe(i,n),k&2&&ge(s,"warning",p[1].ready&&p[1].timeLeft<=15),(!P||k&2&&$!==($=p[1].ready?"Delete file":"Cancel upload"))&&c(g,"alt",$),(!P||k&2&&w!==(w=p[1].ready?"Delete file":"Cancel upload"))&&c(u,"title",w),(!P||k&2)&&W!==(W=Y.shorten(p[1].fileName,30)+"")&&pe(X,W),p[1].ready?y?y.p(p,k):(y=ve(p),y.c(),y.m(e,H)):y&&(y.d(1),y=null)},i(p){P||(N(r.$$.fragment,p),P=!0)},o(p){E(r.$$.fragment,p),P=!1},d(p){p&&m(e),V(r),y&&y.d()}}}function qe(a,e,l){const t=ne.timings.delete;let{roomName:r}=e,{file:o}=e,{index:s}=e;return a.$$set=n=>{"roomName"in n&&l(0,r=n.roomName),"file"in n&&l(1,o=n.file),"index"in n&&l(2,s=n.index)},[r,o,s,t]}class Oe extends q{constructor(e){super(),O(this,e,qe,Ve,G,{roomName:0,file:1,index:2})}}function be(a,e,l){const t=a.slice();return t[2]=e[l],t[4]=l,t}function Ge(a){let e=[],l=new Map,t,r,o=a[1].files;const s=n=>n[4];for(let n=0;n<o.length;n+=1){let i=be(a,o,n),f=s(i);l.set(f,e[n]=we(f,i))}return{c(){for(let n=0;n<e.length;n+=1)e[n].c();t=A()},l(n){for(let i=0;i<e.length;i+=1)e[i].l(n);t=A()},m(n,i){for(let f=0;f<e.length;f+=1)e[f].m(n,i);j(n,t,i),r=!0},p(n,i){i&3&&(o=n[1].files,te(),e=ye(e,i,s,1,n,o,l,t.parentNode,je,we,t,be),le())},i(n){if(!r){for(let i=0;i<o.length;i+=1)N(e[i]);r=!0}},o(n){for(let i=0;i<e.length;i+=1)E(e[i]);r=!1},d(n){for(let i=0;i<e.length;i+=1)e[i].d(n);n&&m(t)}}}function We(a){let e,l,t,r;return{c(){e=_("p"),l=x("Looks like there aren't any files here yet. "),t=_("br"),r=x(`
            Try uploading one by dropping it here or by clicking the upload button.`),this.h()},l(o){e=h(o,"P",{class:!0});var s=b(e);l=z(s,"Looks like there aren't any files here yet. "),t=h(s,"BR",{}),r=z(s,`
            Try uploading one by dropping it here or by clicking the upload button.`),s.forEach(m),this.h()},h(){c(e,"class","bold svelte-13gsupi")},m(o,s){j(o,e,s),d(e,l),d(e,t),d(e,r)},p:D,i:D,o:D,d(o){o&&m(e)}}}function ke(a){let e,l;return e=new Oe({props:{roomName:a[0],file:a[2],index:a[4]}}),{c(){B(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,r){S(e,t,r),l=!0},p(t,r){const o={};r&1&&(o.roomName=t[0]),r&2&&(o.file=t[2]),r&2&&(o.index=t[4]),e.$set(o)},i(t){l||(N(e.$$.fragment,t),l=!0)},o(t){E(e.$$.fragment,t),l=!1},d(t){V(e,t)}}}function we(a,e){let l,t,r,o=e[2]!=null&&ke(e);return{key:a,first:null,c(){l=A(),o&&o.c(),t=A(),this.h()},l(s){l=A(),o&&o.l(s),t=A(),this.h()},h(){this.first=l},m(s,n){j(s,l,n),o&&o.m(s,n),j(s,t,n),r=!0},p(s,n){e=s,e[2]!=null?o?(o.p(e,n),n&2&&N(o,1)):(o=ke(e),o.c(),N(o,1),o.m(t.parentNode,t)):o&&(te(),E(o,1,1,()=>{o=null}),le())},i(s){r||(N(o),r=!0)},o(s){E(o),r=!1},d(s){s&&m(l),o&&o.d(s),s&&m(t)}}}function Je(a){let e,l,t,r;const o=[We,Ge],s=[];function n(i,f){return i[1].files.length==0?0:1}return l=n(a),t=s[l]=o[l](a),{c(){e=_("main"),t.c()},l(i){e=h(i,"MAIN",{});var f=b(e);t.l(f),f.forEach(m)},m(i,f){j(i,e,f),s[l].m(e,null),r=!0},p(i,[f]){let u=l;l=n(i),l===u?s[l].p(i,f):(te(),E(s[u],1,1,()=>{s[u]=null}),le(),t=s[l],t?t.p(i,f):(t=s[l]=o[l](i),t.c()),N(t,1),t.m(e,null))},i(i){r||(N(t),r=!0)},o(i){E(t),r=!1},d(i){i&&m(e),s[l].d()}}}function Xe(a,e,l){let{roomName:t}=e,{roomData:r}=e;return a.$$set=o=>{"roomName"in o&&l(0,t=o.roomName),"roomData"in o&&l(1,r=o.roomData)},[t,r]}class He extends q{constructor(e){super(),O(this,e,Xe,Je,G,{roomName:0,roomData:1})}}function Ke(a){let e,l;return{c:D,l:D,m(t,r){e||(l=[_e(window,"dragover",he(a[2])),_e(window,"drop",he(a[0]))],e=!0)},p:D,i:D,o:D,d(t){e=!1,Ne(l)}}}function Qe(a,e,l){let{onUpload:t}=e;const r=s=>{let n=s.dataTransfer.items;if(n){let i=[];for(let f of n)f.kind=="file"&&i.push(f.getAsFile());i.length!=0&&t(i)}};function o(s){Ee.call(this,a,s)}return a.$$set=s=>{"onUpload"in s&&l(1,t=s.onUpload)},[r,t,o]}class Ye extends q{constructor(e){super(),O(this,e,Qe,Ke,G,{onUpload:1})}}function Ze(a){let e,l,t,r;return e=new He({props:{roomName:a[1],roomData:a[0]}}),t=new Ye({props:{onUpload:a[4]}}),{c(){B(e.$$.fragment),l=T(),B(t.$$.fragment)},l(o){R(e.$$.fragment,o),l=M(o),R(t.$$.fragment,o)},m(o,s){S(e,o,s),j(o,l,s),S(t,o,s),r=!0},p(o,s){const n={};s&2&&(n.roomName=o[1]),s&1&&(n.roomData=o[0]),e.$set(n)},i(o){r||(N(e.$$.fragment,o),N(t.$$.fragment,o),r=!0)},o(o){E(e.$$.fragment,o),E(t.$$.fragment,o),r=!1},d(o){V(e,o),o&&m(l),V(t,o)}}}function et(a){let e,l;return e=new ze({props:{isNetworkError:a[3]}}),{c(){B(e.$$.fragment)},l(t){R(e.$$.fragment,t)},m(t,r){S(e,t,r),l=!0},p(t,r){const o={};r&8&&(o.isNetworkError=t[3]),e.$set(o)},i(t){l||(N(e.$$.fragment,t),l=!0)},o(t){E(e.$$.fragment,t),l=!1},d(t){V(e,t)}}}function tt(a){let e,l,t,r,o,s;l=new De({});const n=[et,Ze],i=[];function f(u,g){return u[2]?0:1}return r=f(a),o=i[r]=n[r](a),{c(){e=_("main"),B(l.$$.fragment),t=T(),o.c()},l(u){e=h(u,"MAIN",{});var g=b(e);R(l.$$.fragment,g),t=M(g),o.l(g),g.forEach(m)},m(u,g){j(u,e,g),S(l,e,null),d(e,t),i[r].m(e,null),s=!0},p(u,[g]){let v=r;r=f(u),r===v?i[r].p(u,g):(te(),E(i[v],1,1,()=>{i[v]=null}),le(),o=i[r],o?o.p(u,g):(o=i[r]=n[r](u),o.c()),N(o,1),o.m(e,null))},i(u){s||(N(l.$$.fragment,u),N(o),s=!0)},o(u){E(l.$$.fragment,u),E(o),s=!1},d(u){u&&m(e),V(l),i[r].d()}}}function lt(a,e,l){let r,o,s=!0,n,i=!1;const f=async v=>{let $=Date.now();try{let w=await fetch(`/room/get/${o}`);w.ok?l(0,r=await w.json()):(l(0,r=null),l(3,i=!1))}catch{l(0,r=null),l(3,i=!0)}r?s&&(n=setTimeout(w=>{l(2,s=!1)},750-(Date.now()-$))):(l(2,s=!0),n!=null&&clearTimeout(n))},u=v=>{location.href="/"},g=v=>{let $=!1;for(let w of v){if(w.size>ee.max.fileSize){$=!0;continue}let U=new FormData;U.set("upload",w),fetch(`room/upload/${o}`,{method:"POST",body:U}),l(0,r.files[r.files.length]={fileName:w.name,timeLeft:0,ready:!1,uploadProgress:0,size:w.size},r)}if($)debugger};return $e(async v=>{if(l(1,o=location.hash.slice(1)),o==""){u();return}await Te(Ie,f),setInterval(f,ee.timings.refreshDelay*1e3)}),[r,o,s,i,g]}class st extends q{constructor(e){super(),O(this,e,lt,tt,G,{})}}export{st as default};
