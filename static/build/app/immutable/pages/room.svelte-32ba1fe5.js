import{S as j,i as V,s as q,e as h,c as b,a as v,d,b as f,g as y,J as m,n as $,t as C,h as z,R as Y,T as Z,f as me,k as T,m as M,P as te,x as A,y as B,U as ge,z as R,j as pe,r as N,p as D,C as S,o as oe,q as ae,l as L,V as xe,W as ye,L as he,M as be,N as Ne,X as Ee,w as De}from"../chunks/index-00bb9875.js";import{T as $e}from"../chunks/TopBar-63190aca.js";let se,le;const Ie=async i=>{se=await(await fetch("/info")).json(),le=se.clientConfig},Te=async(...i)=>{let e=[];for(let l of i)e.push(l());for(let l of e)await l},ee={time:(i,e)=>{let l=Math.floor(i/3600);i-=l*(60*60);let t=Math.floor(i/60);i-=t*60;let o=[l,t,i];return o.splice(0,o.length-e),o.map(r=>r.toString().padStart(2,"0")).join(":")},shorten:(i,e)=>i.length<e?i:i.slice(0,e-3)+"..."};function Me(i){let e;return{c(){e=C("Connecting...")},l(l){e=z(l,"Connecting...")},m(l,t){y(l,e,t)},d(l){l&&d(e)}}}function Pe(i){let e,l,t;return{c(){e=C("Connection error. "),l=h("br"),t=C(`
				Will continue to retry...`)},l(a){e=z(a,"Connection error. "),l=b(a,"BR",{}),t=z(a,`
				Will continue to retry...`)},m(a,o){y(a,e,o),y(a,l,o),y(a,t,o)},d(a){a&&d(e),a&&d(l),a&&d(t)}}}function Ce(i){let e,l,t;function a(n,s){return n[0]?Pe:Me}let o=a(i),r=o(i);return{c(){e=h("main"),l=h("div"),t=h("p"),r.c(),this.h()},l(n){e=b(n,"MAIN",{});var s=v(e);l=b(s,"DIV",{class:!0});var c=v(l);t=b(c,"P",{class:!0});var u=v(t);r.l(u),u.forEach(d),c.forEach(d),s.forEach(d),this.h()},h(){f(t,"class","svelte-ma1ccf"),f(l,"class","svelte-ma1ccf")},m(n,s){y(n,e,s),m(e,l),m(l,t),r.m(t,null)},p(n,[s]){o!==(o=a(n))&&(r.d(1),r=o(n),r&&(r.c(),r.m(t,null)))},i:$,o:$,d(n){n&&d(e),r.d()}}}function ze(i,e,l){let{isNetworkError:t}=e;return i.$$set=a=>{"isNetworkError"in a&&l(0,t=a.isNetworkError)},[t]}class Ue extends j{constructor(e){super(),V(this,e,ze,Ce,q,{isNetworkError:0})}}function Fe(i){let e,l,t,a,o,r;return{c(){e=h("main"),l=Y("svg"),t=Y("circle"),a=Y("circle"),r=Y("circle"),this.h()},l(n){e=b(n,"MAIN",{});var s=v(e);l=Z(s,"svg",{viewBox:!0,class:!0});var c=v(l);t=Z(c,"circle",{id:!0,cx:!0,cy:!0,r:!0,class:!0}),v(t).forEach(d),a=Z(c,"circle",{id:!0,style:!0,"stroke-dasharray":!0,"stroke-width":!0,cx:!0,cy:!0,r:!0,transform:!0,class:!0}),v(a).forEach(d),r=Z(c,"circle",{id:!0,"stroke-width":!0,cx:!0,cy:!0,r:!0,class:!0}),v(r).forEach(d),c.forEach(d),s.forEach(d),this.h()},h(){f(t,"id","background"),f(t,"cx","0.5"),f(t,"cy","0.5"),f(t,"r","0.5"),f(t,"class","svelte-f8zowc"),f(a,"id","slice"),me(a,"transition-duration",i[1]+"s"),f(a,"stroke-dasharray",o=i[0]*(Math.PI/2)+" 3.141592653589793"),f(a,"stroke-width","0.5"),f(a,"cx","0.5"),f(a,"cy","0.5"),f(a,"r","0.25"),f(a,"transform","rotate(-90) translate(-1)"),f(a,"class","svelte-f8zowc"),f(r,"id","outline"),f(r,"stroke-width",W),f(r,"cx","0.5"),f(r,"cy","0.5"),f(r,"r","0.5"),f(r,"class","svelte-f8zowc"),f(l,"viewBox",-W/2+" "+-W/2+" "+(1+W)+" "+(1+W)),f(l,"class","svelte-f8zowc")},m(n,s){y(n,e,s),m(e,l),m(l,t),m(l,a),m(l,r)},p(n,[s]){s&2&&me(a,"transition-duration",n[1]+"s"),s&1&&o!==(o=n[0]*(Math.PI/2)+" 3.141592653589793")&&f(a,"stroke-dasharray",o)},i:$,o:$,d(n){n&&d(e)}}}const W=.015;function Le(i,e,l){let{amount:t}=e,{interpolateTime:a}=e;return i.$$set=o=>{"amount"in o&&l(0,t=o.amount),"interpolateTime"in o&&l(1,a=o.interpolateTime)},[t,a]}class Ae extends j{constructor(e){super(),V(this,e,Le,Fe,q,{amount:0,interpolateTime:1})}}var Be="/app/immutable/assets/download-ddd256eb.svg",Re="/app/immutable/assets/close-02f49dd1.svg",Se="/app/immutable/assets/timer-plus-0c3cdcef.svg",je="/app/immutable/assets/file-document-outline-8da5362f.svg";function _e(i){let e,l,t,a,o,r,n,s,c,u;return{c(){e=h("div"),l=h("button"),t=h("img"),o=T(),r=h("a"),n=h("img"),this.h()},l(p){e=b(p,"DIV",{class:!0});var _=v(e);l=b(_,"BUTTON",{title:!0,class:!0});var I=v(l);t=b(I,"IMG",{src:!0,width:!0,height:!0,alt:!0,class:!0}),I.forEach(d),o=M(_),r=b(_,"A",{href:!0,download:!0,title:!0,class:!0});var w=v(r);n=b(w,"IMG",{src:!0,widt:!0,height:!0,alt:!0,class:!0}),w.forEach(d),_.forEach(d),this.h()},h(){te(t.src,a=Se)||f(t,"src",a),f(t,"width","24"),f(t,"height","24"),f(t,"alt","Extend file time limit"),f(t,"class","svelte-baxtgf"),f(l,"title","Extend the time limit"),f(l,"class","svelte-baxtgf"),te(n.src,s=Be)||f(n,"src",s),f(n,"widt","24"),f(n,"height","24"),f(n,"alt","Download the file"),f(n,"class","svelte-baxtgf"),f(r,"href",c=`/room/get/${i[0]}/${i[2]}`),f(r,"download",u=i[1].fileName),f(r,"title","Download the file"),f(r,"class","svelte-baxtgf"),f(e,"class","bottom svelte-baxtgf")},m(p,_){y(p,e,_),m(e,l),m(l,t),m(e,o),m(e,r),m(r,n)},p(p,_){_&5&&c!==(c=`/room/get/${p[0]}/${p[2]}`)&&f(r,"href",c),_&2&&u!==(u=p[1].fileName)&&f(r,"download",u)},d(p){p&&d(e)}}}function Ve(i){let e,l,t,a,o,r,n,s,c,u,p=(i[1].ready?i[1].downloading?"Downloading...":ee.time(i[1].timeLeft,2):`${Math.floor(i[1].uploadProgress*100)}% Uploaded`)+"",_,I,w,E,J,X,H,re,U,O=ee.shorten(i[1].fileName,30)+"",K,ne,Q,ie,P;s=new Ae({props:{amount:i[1].ready?i[1].timeLeft/(i[1].quickDownloadDelete?i[3].downloadedFile:i[3].newFile):i[1].uploadProgress,interpolateTime:le.timings.refreshDelay}});let x=i[1].ready&&_e(i);return{c(){e=h("main"),l=h("div"),t=h("img"),o=T(),r=h("div"),n=h("div"),A(s.$$.fragment),c=T(),u=h("span"),_=C(p),I=T(),w=h("button"),E=h("img"),re=T(),U=h("p"),K=C(O),ne=T(),x&&x.c(),Q=T(),ie=h("br"),this.h()},l(g){e=b(g,"MAIN",{class:!0});var k=v(e);l=b(k,"DIV",{class:!0});var G=v(l);t=b(G,"IMG",{src:!0,width:!0,height:!0,alt:!0,class:!0}),G.forEach(d),o=M(k),r=b(k,"DIV",{class:!0});var F=v(r);n=b(F,"DIV",{class:!0});var fe=v(n);B(s.$$.fragment,fe),fe.forEach(d),c=M(F),u=b(F,"SPAN",{class:!0});var ce=v(u);_=z(ce,p),ce.forEach(d),I=M(F),w=b(F,"BUTTON",{title:!0,class:!0});var ue=v(w);E=b(ue,"IMG",{src:!0,width:!0,height:!0,alt:!0,class:!0}),ue.forEach(d),F.forEach(d),re=M(k),U=b(k,"P",{class:!0});var de=v(U);K=z(de,O),de.forEach(d),ne=M(k),x&&x.l(k),Q=M(k),ie=b(k,"BR",{}),k.forEach(d),this.h()},h(){te(t.src,a=je)||f(t,"src",a),f(t,"width","24"),f(t,"height","24"),f(t,"alt","A file icon"),f(t,"class","svelte-baxtgf"),f(l,"class","background svelte-baxtgf"),f(n,"class","piechart svelte-baxtgf"),f(u,"class","svelte-baxtgf"),ge(u,"warning",i[1].ready&&!i[1].downloading&&i[1].timeLeft<=15),te(E.src,J=Re)||f(E,"src",J),f(E,"width","24"),f(E,"height","24"),f(E,"alt",X=i[1].ready?"Delete the file":"Cancel upload"),f(E,"class","svelte-baxtgf"),f(w,"title",H=i[1].ready?"Delete the file":"Cancel upload"),f(w,"class","svelte-baxtgf"),f(r,"class","top svelte-baxtgf"),f(U,"class","title svelte-baxtgf"),f(e,"class","svelte-baxtgf")},m(g,k){y(g,e,k),m(e,l),m(l,t),m(e,o),m(e,r),m(r,n),R(s,n,null),m(r,c),m(r,u),m(u,_),m(r,I),m(r,w),m(w,E),m(e,re),m(e,U),m(U,K),m(e,ne),x&&x.m(e,null),m(e,Q),m(e,ie),P=!0},p(g,[k]){const G={};k&2&&(G.amount=g[1].ready?g[1].timeLeft/(g[1].quickDownloadDelete?g[3].downloadedFile:g[3].newFile):g[1].uploadProgress),s.$set(G),(!P||k&2)&&p!==(p=(g[1].ready?g[1].downloading?"Downloading...":ee.time(g[1].timeLeft,2):`${Math.floor(g[1].uploadProgress*100)}% Uploaded`)+"")&&pe(_,p),k&2&&ge(u,"warning",g[1].ready&&!g[1].downloading&&g[1].timeLeft<=15),(!P||k&2&&X!==(X=g[1].ready?"Delete the file":"Cancel upload"))&&f(E,"alt",X),(!P||k&2&&H!==(H=g[1].ready?"Delete the file":"Cancel upload"))&&f(w,"title",H),(!P||k&2)&&O!==(O=ee.shorten(g[1].fileName,30)+"")&&pe(K,O),g[1].ready?x?x.p(g,k):(x=_e(g),x.c(),x.m(e,Q)):x&&(x.d(1),x=null)},i(g){P||(N(s.$$.fragment,g),P=!0)},o(g){D(s.$$.fragment,g),P=!1},d(g){g&&d(e),S(s),x&&x.d()}}}function qe(i,e,l){const t=se.timings.delete;let{roomName:a}=e,{file:o}=e,{index:r}=e;return i.$$set=n=>{"roomName"in n&&l(0,a=n.roomName),"file"in n&&l(1,o=n.file),"index"in n&&l(2,r=n.index)},[a,o,r,t]}class Oe extends j{constructor(e){super(),V(this,e,qe,Ve,q,{roomName:0,file:1,index:2})}}function ve(i,e,l){const t=i.slice();return t[2]=e[l],t[4]=l,t}function Ge(i){let e=[],l=new Map,t,a,o=i[1].files;const r=n=>n[4];for(let n=0;n<o.length;n+=1){let s=ve(i,o,n),c=r(s);l.set(c,e[n]=ke(c,s))}return{c(){for(let n=0;n<e.length;n+=1)e[n].c();t=L()},l(n){for(let s=0;s<e.length;s+=1)e[s].l(n);t=L()},m(n,s){for(let c=0;c<e.length;c+=1)e[c].m(n,s);y(n,t,s),a=!0},p(n,s){s&3&&(o=n[1].files,oe(),e=xe(e,s,r,1,n,o,l,t.parentNode,ye,ke,t,ve),ae())},i(n){if(!a){for(let s=0;s<o.length;s+=1)N(e[s]);a=!0}},o(n){for(let s=0;s<e.length;s+=1)D(e[s]);a=!1},d(n){for(let s=0;s<e.length;s+=1)e[s].d(n);n&&d(t)}}}function We(i){let e,l,t,a;return{c(){e=h("p"),l=C("Looks like there aren't any files here yet. "),t=h("br"),a=C(`
            Try uploading one by dropping it here or by clicking the upload button.`),this.h()},l(o){e=b(o,"P",{class:!0});var r=v(e);l=z(r,"Looks like there aren't any files here yet. "),t=b(r,"BR",{}),a=z(r,`
            Try uploading one by dropping it here or by clicking the upload button.`),r.forEach(d),this.h()},h(){f(e,"class","bold svelte-13gsupi")},m(o,r){y(o,e,r),m(e,l),m(e,t),m(e,a)},p:$,i:$,o:$,d(o){o&&d(e)}}}function we(i){let e,l;return e=new Oe({props:{roomName:i[0],file:i[2],index:i[4]}}),{c(){A(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,a){R(e,t,a),l=!0},p(t,a){const o={};a&1&&(o.roomName=t[0]),a&2&&(o.file=t[2]),a&2&&(o.index=t[4]),e.$set(o)},i(t){l||(N(e.$$.fragment,t),l=!0)},o(t){D(e.$$.fragment,t),l=!1},d(t){S(e,t)}}}function ke(i,e){let l,t,a,o=e[2]!=null&&we(e);return{key:i,first:null,c(){l=L(),o&&o.c(),t=L(),this.h()},l(r){l=L(),o&&o.l(r),t=L(),this.h()},h(){this.first=l},m(r,n){y(r,l,n),o&&o.m(r,n),y(r,t,n),a=!0},p(r,n){e=r,e[2]!=null?o?(o.p(e,n),n&2&&N(o,1)):(o=we(e),o.c(),N(o,1),o.m(t.parentNode,t)):o&&(oe(),D(o,1,1,()=>{o=null}),ae())},i(r){a||(N(o),a=!0)},o(r){D(o),a=!1},d(r){r&&d(l),o&&o.d(r),r&&d(t)}}}function Je(i){let e,l,t,a;const o=[We,Ge],r=[];function n(s,c){return s[1].files.length==0?0:1}return l=n(i),t=r[l]=o[l](i),{c(){e=h("main"),t.c()},l(s){e=b(s,"MAIN",{});var c=v(e);t.l(c),c.forEach(d)},m(s,c){y(s,e,c),r[l].m(e,null),a=!0},p(s,[c]){let u=l;l=n(s),l===u?r[l].p(s,c):(oe(),D(r[u],1,1,()=>{r[u]=null}),ae(),t=r[l],t?t.p(s,c):(t=r[l]=o[l](s),t.c()),N(t,1),t.m(e,null))},i(s){a||(N(t),a=!0)},o(s){D(t),a=!1},d(s){s&&d(e),r[l].d()}}}function Xe(i,e,l){let{roomName:t}=e,{roomData:a}=e;return i.$$set=o=>{"roomName"in o&&l(0,t=o.roomName),"roomData"in o&&l(1,a=o.roomData)},[t,a]}class He extends j{constructor(e){super(),V(this,e,Xe,Je,q,{roomName:0,roomData:1})}}function Ke(i){let e,l;return{c:$,l:$,m(t,a){e||(l=[he(window,"dragover",be(i[2])),he(window,"drop",be(i[0]))],e=!0)},p:$,i:$,o:$,d(t){e=!1,Ne(l)}}}function Qe(i,e,l){let{onUpload:t}=e;const a=r=>{let n=r.dataTransfer.items;if(n){let s=[];for(let c of n)c.kind=="file"&&s.push(c.getAsFile());s.length!=0&&t(s)}};function o(r){Ee.call(this,i,r)}return i.$$set=r=>{"onUpload"in r&&l(1,t=r.onUpload)},[a,t,o]}class Ye extends j{constructor(e){super(),V(this,e,Qe,Ke,q,{onUpload:1})}}function Ze(i){let e,l,t,a;return e=new He({props:{roomName:i[1],roomData:i[0]}}),t=new Ye({props:{onUpload:i[4]}}),{c(){A(e.$$.fragment),l=T(),A(t.$$.fragment)},l(o){B(e.$$.fragment,o),l=M(o),B(t.$$.fragment,o)},m(o,r){R(e,o,r),y(o,l,r),R(t,o,r),a=!0},p(o,r){const n={};r&2&&(n.roomName=o[1]),r&1&&(n.roomData=o[0]),e.$set(n)},i(o){a||(N(e.$$.fragment,o),N(t.$$.fragment,o),a=!0)},o(o){D(e.$$.fragment,o),D(t.$$.fragment,o),a=!1},d(o){S(e,o),o&&d(l),S(t,o)}}}function et(i){let e,l;return e=new Ue({props:{isNetworkError:i[3]}}),{c(){A(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,a){R(e,t,a),l=!0},p(t,a){const o={};a&8&&(o.isNetworkError=t[3]),e.$set(o)},i(t){l||(N(e.$$.fragment,t),l=!0)},o(t){D(e.$$.fragment,t),l=!1},d(t){S(e,t)}}}function tt(i){let e,l,t,a,o,r;l=new $e({});const n=[et,Ze],s=[];function c(u,p){return u[2]?0:1}return a=c(i),o=s[a]=n[a](i),{c(){e=h("main"),A(l.$$.fragment),t=T(),o.c()},l(u){e=b(u,"MAIN",{});var p=v(e);B(l.$$.fragment,p),t=M(p),o.l(p),p.forEach(d)},m(u,p){y(u,e,p),R(l,e,null),m(e,t),s[a].m(e,null),r=!0},p(u,[p]){let _=a;a=c(u),a===_?s[a].p(u,p):(oe(),D(s[_],1,1,()=>{s[_]=null}),ae(),o=s[a],o?o.p(u,p):(o=s[a]=n[a](u),o.c()),N(o,1),o.m(e,null))},i(u){r||(N(l.$$.fragment,u),N(o),r=!0)},o(u){D(l.$$.fragment,u),D(o),r=!1},d(u){u&&d(e),S(l),s[a].d()}}}function lt(i,e,l){let a,o,r=!0,n,s=!1;const c=async _=>{let I=Date.now();try{let w=await fetch(`/room/get/${o}`);w.ok?l(0,a=await w.json()):(l(0,a=null),l(3,s=!1))}catch{l(0,a=null),l(3,s=!0)}a?r&&(n=setTimeout(w=>{l(2,r=!1)},750-(Date.now()-I))):(l(2,r=!0),n!=null&&clearTimeout(n))},u=_=>{location.href="/"},p=_=>{let I=!1;for(let w of _){if(w.size>le.max.fileSize){I=!0;continue}let E=new FormData;E.set("upload",w),fetch(`room/upload/${o}`,{method:"POST",body:E}).catch(J=>{console.log(J.name)}),l(0,a.files[a.files.length]={fileName:w.name,timeLeft:0,ready:!1,uploadProgress:0,size:w.size},a)}if(I)debugger};return De(async _=>{if(l(1,o=location.hash.slice(1)),o==""){u();return}await Te(Ie,c),setInterval(c,le.timings.refreshDelay*1e3)}),[a,o,r,s,p]}class rt extends j{constructor(e){super(),V(this,e,lt,tt,q,{})}}export{rt as default};
