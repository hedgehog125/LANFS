import{S as M,i as T,s as U,e as g,t as q,c as $,a as v,h as B,d as m,b,g as d,J as N,n as _,l as y,k as A,m as P,j as L,R as J,T as V,L as R,M as j,N as x,U as G,x as C,y as D,z as I,p as w,q as H,r as k,C as E,w as K,o as Q}from"../chunks/index-4db9d871.js";import{T as W}from"../chunks/TopBar-3e00bcec.js";function X(s){let e,o,a,l;return{c(){e=g("main"),o=g("div"),a=g("p"),l=q("Connecting..."),this.h()},l(t){e=$(t,"MAIN",{});var n=v(e);o=$(n,"DIV",{class:!0});var i=v(o);a=$(i,"P",{class:!0});var r=v(a);l=B(r,"Connecting..."),r.forEach(m),i.forEach(m),n.forEach(m),this.h()},h(){b(a,"class","svelte-m0zg86"),b(o,"class","svelte-m0zg86")},m(t,n){d(t,e,n),N(e,o),N(o,a),N(a,l)},p:_,i:_,o:_,d(t){t&&m(e)}}}class Y extends M{constructor(e){super(),T(this,e,null,X,U,{})}}function F(s,e,o){const a=s.slice();return a[2]=e[o],a[4]=o,a}function O(s){let e,o=s[2].fileName+"",a,l,t,n,i;return{c(){e=g("a"),a=q(o),n=A(),i=g("br"),this.h()},l(r){e=$(r,"A",{href:!0,download:!0});var f=v(e);a=B(f,o),f.forEach(m),n=P(r),i=$(r,"BR",{}),this.h()},h(){b(e,"href",l=`/room/get/${s[0]}/${s[4]}`),b(e,"download",t=s[2].fileName)},m(r,f){d(r,e,f),N(e,a),d(r,n,f),d(r,i,f)},p(r,f){f&2&&o!==(o=r[2].fileName+"")&&L(a,o),f&3&&l!==(l=`/room/get/${r[0]}/${r[4]}`)&&b(e,"href",l),f&2&&t!==(t=r[2].fileName)&&b(e,"download",t)},d(r){r&&m(e),r&&m(n),r&&m(i)}}}function S(s,e){let o,a,l=e[2]!=null&&O(e);return{key:s,first:null,c(){o=y(),l&&l.c(),a=y(),this.h()},l(t){o=y(),l&&l.l(t),a=y(),this.h()},h(){this.first=o},m(t,n){d(t,o,n),l&&l.m(t,n),d(t,a,n)},p(t,n){e=t,e[2]!=null?l?l.p(e,n):(l=O(e),l.c(),l.m(a.parentNode,a)):l&&(l.d(1),l=null)},d(t){t&&m(o),l&&l.d(t),t&&m(a)}}}function Z(s){let e,o=[],a=new Map,l=s[1].files;const t=n=>n[4];for(let n=0;n<l.length;n+=1){let i=F(s,l,n),r=t(i);a.set(r,o[n]=S(r,i))}return{c(){e=g("main");for(let n=0;n<o.length;n+=1)o[n].c()},l(n){e=$(n,"MAIN",{});var i=v(e);for(let r=0;r<o.length;r+=1)o[r].l(i);i.forEach(m)},m(n,i){d(n,e,i);for(let r=0;r<o.length;r+=1)o[r].m(e,null)},p(n,[i]){i&3&&(l=n[1].files,o=J(o,i,t,1,n,l,a,e,V,S,null,F))},i:_,o:_,d(n){n&&m(e);for(let i=0;i<o.length;i+=1)o[i].d()}}}function ee(s,e,o){let{roomName:a}=e,{roomData:l}=e;return s.$$set=t=>{"roomName"in t&&o(0,a=t.roomName),"roomData"in t&&o(1,l=t.roomData)},[a,l]}class te extends M{constructor(e){super(),T(this,e,ee,Z,U,{roomName:0,roomData:1})}}function oe(s){let e,o;return{c:_,l:_,m(a,l){e||(o=[R(window,"dragover",j(s[2])),R(window,"drop",j(s[0]))],e=!0)},p:_,i:_,o:_,d(a){e=!1,x(o)}}}function ne(s,e,o){let{onUpload:a}=e;const l=n=>{let i=n.dataTransfer.items;if(i){let r=[];for(let f of i)f.kind=="file"&&r.push(f.getAsFile());r.length!=0&&a(r)}};function t(n){G.call(this,s,n)}return s.$$set=n=>{"onUpload"in n&&o(1,a=n.onUpload)},[l,a,t]}class le extends M{constructor(e){super(),T(this,e,ne,oe,U,{onUpload:1})}}function ae(s){let e,o,a,l;return e=new te({props:{roomName:s[1],roomData:s[0]}}),a=new le({props:{onUpload:s[3]}}),{c(){C(e.$$.fragment),o=A(),C(a.$$.fragment)},l(t){D(e.$$.fragment,t),o=P(t),D(a.$$.fragment,t)},m(t,n){I(e,t,n),d(t,o,n),I(a,t,n),l=!0},p(t,n){const i={};n&2&&(i.roomName=t[1]),n&1&&(i.roomData=t[0]),e.$set(i)},i(t){l||(k(e.$$.fragment,t),k(a.$$.fragment,t),l=!0)},o(t){w(e.$$.fragment,t),w(a.$$.fragment,t),l=!1},d(t){E(e,t),t&&m(o),E(a,t)}}}function re(s){let e,o;return e=new Y({}),{c(){C(e.$$.fragment)},l(a){D(e.$$.fragment,a)},m(a,l){I(e,a,l),o=!0},p:_,i(a){o||(k(e.$$.fragment,a),o=!0)},o(a){w(e.$$.fragment,a),o=!1},d(a){E(e,a)}}}function ie(s){let e,o,a,l,t,n;o=new W({});const i=[re,ae],r=[];function f(c,u){return c[2]?0:1}return l=f(s),t=r[l]=i[l](s),{c(){e=g("main"),C(o.$$.fragment),a=A(),t.c()},l(c){e=$(c,"MAIN",{});var u=v(e);D(o.$$.fragment,u),a=P(u),t.l(u),u.forEach(m)},m(c,u){d(c,e,u),I(o,e,null),N(e,a),r[l].m(e,null),n=!0},p(c,[u]){let p=l;l=f(c),l===p?r[l].p(c,u):(Q(),w(r[p],1,1,()=>{r[p]=null}),H(),t=r[l],t?t.p(c,u):(t=r[l]=i[l](c),t.c()),k(t,1),t.m(e,null))},i(c){n||(k(o.$$.fragment,c),k(t),n=!0)},o(c){w(o.$$.fragment,c),w(t),n=!1},d(c){c&&m(e),E(o),r[l].d()}}}function se(s,e,o){let l,t,n,i=!0;const r=async p=>{let h=await fetch(`/room/get/${n}`);o(0,t=await h.json())},f=async p=>{l=(await(await fetch("/info")).json()).clientConfig},c=p=>{location.href="/"},u=p=>{for(let h of p){let z=new FormData;z.set("upload",h),fetch(`room/upload/${n}`,{method:"POST",body:z}),o(0,t.files[t.files.length]={fileName:h.name,timeLeft:0,ready:!1},t)}};return K(async p=>{let h=Date.now();if(o(1,n=location.hash.slice(1)),n==""){c();return}r(),await f(),setTimeout(z=>{o(2,i=!1),setInterval(r,l.timings.refreshDelay*1e3)},750-(Date.now()-h))}),[t,n,i,u]}class me extends M{constructor(e){super(),T(this,e,se,ie,U,{})}}export{me as default};
