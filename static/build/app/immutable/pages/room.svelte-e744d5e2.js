import{S as G,i as W,s as J,e as p,k as D,c as h,a as b,d as u,m as I,b as f,g as _,J as d,P as $,L as ne,R as Me,n as M,t as q,l as P,h as L,j as fe,T as Pe,U as Q,V as ee,f as pe,x as O,y as S,W as he,z as j,r as E,p as C,C as V,o as oe,q as ae,X as Te,Y as ze,M as _e,N as Ue,Z as qe,w as Le}from"../chunks/index-bc183bf6.js";import{T as Be}from"../chunks/TopBar-a2cdd3cf.js";let ce,le;const Fe=async s=>{ce=await(await fetch("/info")).json(),le=ce.clientConfig},Ae=async(...s)=>{let e=[];for(let t of s)e.push(t());for(let t of e)await t},te={time:(s,e)=>{let t=Math.floor(s/3600);s-=t*(60*60);let l=Math.floor(s/60);s-=l*60;let a=[t,l,s];return a.splice(0,a.length-e),a.map(o=>o.toString().padStart(2,"0")).join(":")},shorten:(s,e)=>s.length<e?s:s.slice(0,e-3)+"..."};var Ie="/app/immutable/assets/close-02f49dd1.svg";function be(s,e,t){const l=s.slice();return l[6]=e[t],l[8]=t,l}function ve(s){let e,t,l;function i(n,c){return n[1]?Oe:Re}let a=i(s),o=a(s),r=!s[1]&&ye(s);return{c(){e=p("div"),t=p("p"),o.c(),l=D(),r&&r.c(),this.h()},l(n){e=h(n,"DIV",{class:!0});var c=b(e);t=h(c,"P",{class:!0});var m=b(t);o.l(m),m.forEach(u),l=I(c),r&&r.l(c),c.forEach(u),this.h()},h(){f(t,"class","svelte-11kgd8q"),f(e,"class","svelte-11kgd8q")},m(n,c){_(n,e,c),d(e,t),o.m(t,null),d(e,l),r&&r.m(e,null)},p(n,c){a===(a=i(n))&&o?o.p(n,c):(o.d(1),o=a(n),o&&(o.c(),o.m(t,null))),n[1]?r&&(r.d(1),r=null):r?r.p(n,c):(r=ye(n),r.c(),r.m(e,null))},d(n){n&&u(e),o.d(),r&&r.d()}}}function Re(s){let e,t=s[4],l=[];for(let i=0;i<t.length;i+=1)l[i]=we(be(s,t,i));return{c(){for(let i=0;i<l.length;i+=1)l[i].c();e=P()},l(i){for(let a=0;a<l.length;a+=1)l[a].l(i);e=P()},m(i,a){for(let o=0;o<l.length;o+=1)l[o].m(i,a);_(i,e,a)},p(i,a){if(a&16){t=i[4];let o;for(o=0;o<t.length;o+=1){const r=be(i,t,o);l[o]?l[o].p(r,a):(l[o]=we(r),l[o].c(),l[o].m(e.parentNode,e))}for(;o<l.length;o+=1)l[o].d(1);l.length=t.length}},d(i){Pe(l,i),i&&u(e)}}}function Oe(s){let e;function t(a,o){return a[0]?je:Se}let l=t(s),i=l(s);return{c(){i.c(),e=P()},l(a){i.l(a),e=P()},m(a,o){i.m(a,o),_(a,e,o)},p(a,o){l!==(l=t(a))&&(i.d(1),i=l(a),i&&(i.c(),i.m(e.parentNode,e)))},d(a){i.d(a),a&&u(e)}}}function ke(s){let e;return{c(){e=p("br")},l(t){e=h(t,"BR",{})},m(t,l){_(t,e,l)},d(t){t&&u(e)}}}function we(s){let e=s[6]+"",t,l,i,a=s[8]!=s[4].length-1&&ke();return{c(){t=q(e),l=D(),a&&a.c(),i=P()},l(o){t=L(o,e),l=I(o),a&&a.l(o),i=P()},m(o,r){_(o,t,r),_(o,l,r),a&&a.m(o,r),_(o,i,r)},p(o,r){r&16&&e!==(e=o[6]+"")&&fe(t,e),o[8]!=o[4].length-1?a||(a=ke(),a.c(),a.m(i.parentNode,i)):a&&(a.d(1),a=null)},d(o){o&&u(t),o&&u(l),a&&a.d(o),o&&u(i)}}}function Se(s){let e;return{c(){e=q("Connecting...")},l(t){e=L(t,"Connecting...")},m(t,l){_(t,e,l)},d(t){t&&u(e)}}}function je(s){let e,t,l;return{c(){e=q("Connection error. "),t=p("br"),l=q(`
						Will continue to retry...`)},l(i){e=L(i,"Connection error. "),t=h(i,"BR",{}),l=L(i,`
						Will continue to retry...`)},m(i,a){_(i,e,a),_(i,t,a),_(i,l,a)},d(i){i&&u(e),i&&u(t),i&&u(l)}}}function ye(s){let e,t,l,i,a;return{c(){e=p("button"),t=p("img"),this.h()},l(o){e=h(o,"BUTTON",{type:!0,title:!0,class:!0});var r=b(e);t=h(r,"IMG",{src:!0,width:!0,height:!0,alt:!0,class:!0}),r.forEach(u),this.h()},h(){$(t.src,l=Ie)||f(t,"src",l),f(t,"width","24"),f(t,"height","24"),f(t,"alt","Close"),f(t,"class","svelte-11kgd8q"),f(e,"type","button"),f(e,"title","Close"),f(e,"class","svelte-11kgd8q")},m(o,r){_(o,e,r),d(e,t),i||(a=ne(e,"click",function(){Me(s[3])&&s[3].apply(this,arguments)}),i=!0)},p(o,r){s=o},d(o){o&&u(e),i=!1,a()}}}function Ve(s){let e,t=(s[1]||s[2]!=-1)&&ve(s);return{c(){e=p("main"),t&&t.c(),this.h()},l(l){e=h(l,"MAIN",{class:!0});var i=b(e);t&&t.l(i),i.forEach(u),this.h()},h(){f(e,"class","svelte-11kgd8q")},m(l,i){_(l,e,i),t&&t.m(e,null)},p(l,[i]){l[1]||l[2]!=-1?t?t.p(l,i):(t=ve(l),t.c(),t.m(e,null)):t&&(t.d(1),t=null)},i:M,o:M,d(l){l&&u(e),t&&t.d()}}}function Ge(s,e,t){let l,{isNetworkError:i}=e,{loading:a}=e,{popupMessageCode:o}=e,{handlePopupClose:r}=e;const n=[["Oh no.","Looks like that file's too big."]];return s.$$set=c=>{"isNetworkError"in c&&t(0,i=c.isNetworkError),"loading"in c&&t(1,a=c.loading),"popupMessageCode"in c&&t(2,o=c.popupMessageCode),"handlePopupClose"in c&&t(3,r=c.handlePopupClose)},s.$$.update=()=>{s.$$.dirty&4&&t(4,l=n[o])},[i,a,o,r,l]}class We extends G{constructor(e){super(),W(this,e,Ge,Ve,J,{isNetworkError:0,loading:1,popupMessageCode:2,handlePopupClose:3})}}function Je(s){let e,t,l,i,a,o;return{c(){e=p("main"),t=Q("svg"),l=Q("circle"),i=Q("circle"),o=Q("circle"),this.h()},l(r){e=h(r,"MAIN",{});var n=b(e);t=ee(n,"svg",{viewBox:!0,class:!0});var c=b(t);l=ee(c,"circle",{id:!0,cx:!0,cy:!0,r:!0,class:!0}),b(l).forEach(u),i=ee(c,"circle",{id:!0,style:!0,"stroke-dasharray":!0,"stroke-width":!0,cx:!0,cy:!0,r:!0,transform:!0,class:!0}),b(i).forEach(u),o=ee(c,"circle",{id:!0,"stroke-width":!0,cx:!0,cy:!0,r:!0,class:!0}),b(o).forEach(u),c.forEach(u),n.forEach(u),this.h()},h(){f(l,"id","background"),f(l,"cx","0.5"),f(l,"cy","0.5"),f(l,"r","0.5"),f(l,"class","svelte-f8zowc"),f(i,"id","slice"),pe(i,"transition-duration",s[1]+"s"),f(i,"stroke-dasharray",a=s[0]*(Math.PI/2)+" 3.141592653589793"),f(i,"stroke-width","0.5"),f(i,"cx","0.5"),f(i,"cy","0.5"),f(i,"r","0.25"),f(i,"transform","rotate(-90) translate(-1)"),f(i,"class","svelte-f8zowc"),f(o,"id","outline"),f(o,"stroke-width",Z),f(o,"cx","0.5"),f(o,"cy","0.5"),f(o,"r","0.5"),f(o,"class","svelte-f8zowc"),f(t,"viewBox",-Z/2+" "+-Z/2+" "+(1+Z)+" "+(1+Z)),f(t,"class","svelte-f8zowc")},m(r,n){_(r,e,n),d(e,t),d(t,l),d(t,i),d(t,o)},p(r,[n]){n&2&&pe(i,"transition-duration",r[1]+"s"),n&1&&a!==(a=r[0]*(Math.PI/2)+" 3.141592653589793")&&f(i,"stroke-dasharray",a)},i:M,o:M,d(r){r&&u(e)}}}const Z=.015;function Xe(s,e,t){let{amount:l}=e,{interpolateTime:i}=e;return s.$$set=a=>{"amount"in a&&t(0,l=a.amount),"interpolateTime"in a&&t(1,i=a.interpolateTime)},[l,i]}class Ye extends G{constructor(e){super(),W(this,e,Xe,Je,J,{amount:0,interpolateTime:1})}}var Ze="/app/immutable/assets/download-ddd256eb.svg",$e="/app/immutable/assets/timer-plus-0c3cdcef.svg",He="/app/immutable/assets/file-document-outline-8da5362f.svg";function xe(s){let e,t,l,i,a,o,r,n,c,m;return{c(){e=p("div"),t=p("button"),l=p("img"),a=D(),o=p("a"),r=p("img"),this.h()},l(k){e=h(k,"DIV",{class:!0});var y=b(e);t=h(y,"BUTTON",{title:!0,class:!0});var z=b(t);l=h(z,"IMG",{src:!0,width:!0,height:!0,alt:!0,class:!0}),z.forEach(u),a=I(y),o=h(y,"A",{href:!0,download:!0,title:!0,class:!0});var w=b(o);r=h(w,"IMG",{src:!0,widt:!0,height:!0,alt:!0,class:!0}),w.forEach(u),y.forEach(u),this.h()},h(){$(l.src,i=$e)||f(l,"src",i),f(l,"width","24"),f(l,"height","24"),f(l,"alt","Extend file time limit"),f(l,"class","svelte-baxtgf"),f(t,"title","Extend the time limit"),f(t,"class","svelte-baxtgf"),$(r.src,n=Ze)||f(r,"src",n),f(r,"widt","24"),f(r,"height","24"),f(r,"alt","Download the file"),f(r,"class","svelte-baxtgf"),f(o,"href",c=`/room/get/${s[0]}/${s[2]}`),f(o,"download",m=s[1].fileName),f(o,"title","Download the file"),f(o,"class","svelte-baxtgf"),f(e,"class","bottom svelte-baxtgf")},m(k,y){_(k,e,y),d(e,t),d(t,l),d(e,a),d(e,o),d(o,r)},p(k,y){y&5&&c!==(c=`/room/get/${k[0]}/${k[2]}`)&&f(o,"href",c),y&2&&m!==(m=k[1].fileName)&&f(o,"download",m)},d(k){k&&u(e)}}}function Ke(s){let e,t,l,i,a,o,r,n,c,m,k=(s[1].ready?s[1].downloading?"Downloading...":te.time(s[1].timeLeft,2):`${Math.floor(s[1].uploadProgress*100)}% Uploaded`)+"",y,z,w,N,T,B,F,ie,A,X=te.shorten(s[1].fileName,30)+"",H,re,K,se,U;n=new Ye({props:{amount:s[1].ready?s[1].timeLeft/(s[1].quickDownloadDelete?s[3].downloadedFile:s[3].newFile):s[1].uploadProgress,interpolateTime:le.timings.refreshDelay}});let x=s[1].ready&&xe(s);return{c(){e=p("main"),t=p("div"),l=p("img"),a=D(),o=p("div"),r=p("div"),O(n.$$.fragment),c=D(),m=p("span"),y=q(k),z=D(),w=p("button"),N=p("img"),ie=D(),A=p("p"),H=q(X),re=D(),x&&x.c(),K=D(),se=p("br"),this.h()},l(g){e=h(g,"MAIN",{class:!0});var v=b(e);t=h(v,"DIV",{class:!0});var Y=b(t);l=h(Y,"IMG",{src:!0,width:!0,height:!0,alt:!0,class:!0}),Y.forEach(u),a=I(v),o=h(v,"DIV",{class:!0});var R=b(o);r=h(R,"DIV",{class:!0});var ue=b(r);S(n.$$.fragment,ue),ue.forEach(u),c=I(R),m=h(R,"SPAN",{class:!0});var de=b(m);y=L(de,k),de.forEach(u),z=I(R),w=h(R,"BUTTON",{title:!0,class:!0});var ge=b(w);N=h(ge,"IMG",{src:!0,width:!0,height:!0,alt:!0,class:!0}),ge.forEach(u),R.forEach(u),ie=I(v),A=h(v,"P",{class:!0});var me=b(A);H=L(me,X),me.forEach(u),re=I(v),x&&x.l(v),K=I(v),se=h(v,"BR",{}),v.forEach(u),this.h()},h(){$(l.src,i=He)||f(l,"src",i),f(l,"width","24"),f(l,"height","24"),f(l,"alt","A file icon"),f(l,"class","svelte-baxtgf"),f(t,"class","background svelte-baxtgf"),f(r,"class","piechart svelte-baxtgf"),f(m,"class","svelte-baxtgf"),he(m,"warning",s[1].ready&&!s[1].downloading&&s[1].timeLeft<=15),$(N.src,T=Ie)||f(N,"src",T),f(N,"width","24"),f(N,"height","24"),f(N,"alt",B=s[1].ready?"Delete the file":"Cancel upload"),f(N,"class","svelte-baxtgf"),f(w,"title",F=s[1].ready?"Delete the file":"Cancel upload"),f(w,"class","svelte-baxtgf"),f(o,"class","top svelte-baxtgf"),f(A,"class","title svelte-baxtgf"),f(e,"class","svelte-baxtgf")},m(g,v){_(g,e,v),d(e,t),d(t,l),d(e,a),d(e,o),d(o,r),j(n,r,null),d(o,c),d(o,m),d(m,y),d(o,z),d(o,w),d(w,N),d(e,ie),d(e,A),d(A,H),d(e,re),x&&x.m(e,null),d(e,K),d(e,se),U=!0},p(g,[v]){const Y={};v&2&&(Y.amount=g[1].ready?g[1].timeLeft/(g[1].quickDownloadDelete?g[3].downloadedFile:g[3].newFile):g[1].uploadProgress),n.$set(Y),(!U||v&2)&&k!==(k=(g[1].ready?g[1].downloading?"Downloading...":te.time(g[1].timeLeft,2):`${Math.floor(g[1].uploadProgress*100)}% Uploaded`)+"")&&fe(y,k),v&2&&he(m,"warning",g[1].ready&&!g[1].downloading&&g[1].timeLeft<=15),(!U||v&2&&B!==(B=g[1].ready?"Delete the file":"Cancel upload"))&&f(N,"alt",B),(!U||v&2&&F!==(F=g[1].ready?"Delete the file":"Cancel upload"))&&f(w,"title",F),(!U||v&2)&&X!==(X=te.shorten(g[1].fileName,30)+"")&&fe(H,X),g[1].ready?x?x.p(g,v):(x=xe(g),x.c(),x.m(e,K)):x&&(x.d(1),x=null)},i(g){U||(E(n.$$.fragment,g),U=!0)},o(g){C(n.$$.fragment,g),U=!1},d(g){g&&u(e),V(n),x&&x.d()}}}function Qe(s,e,t){const l=ce.timings.delete;let{roomName:i}=e,{file:a}=e,{index:o}=e;return s.$$set=r=>{"roomName"in r&&t(0,i=r.roomName),"file"in r&&t(1,a=r.file),"index"in r&&t(2,o=r.index)},[i,a,o,l]}class et extends G{constructor(e){super(),W(this,e,Qe,Ke,J,{roomName:0,file:1,index:2})}}function Ne(s,e,t){const l=s.slice();return l[2]=e[t],l[4]=t,l}function tt(s){let e=[],t=new Map,l,i,a=s[1].files;const o=r=>r[4];for(let r=0;r<a.length;r+=1){let n=Ne(s,a,r),c=o(n);t.set(c,e[r]=Ce(c,n))}return{c(){for(let r=0;r<e.length;r+=1)e[r].c();l=P()},l(r){for(let n=0;n<e.length;n+=1)e[n].l(r);l=P()},m(r,n){for(let c=0;c<e.length;c+=1)e[c].m(r,n);_(r,l,n),i=!0},p(r,n){n&3&&(a=r[1].files,oe(),e=Te(e,n,o,1,r,a,t,l.parentNode,ze,Ce,l,Ne),ae())},i(r){if(!i){for(let n=0;n<a.length;n+=1)E(e[n]);i=!0}},o(r){for(let n=0;n<e.length;n+=1)C(e[n]);i=!1},d(r){for(let n=0;n<e.length;n+=1)e[n].d(r);r&&u(l)}}}function lt(s){let e,t,l,i;return{c(){e=p("p"),t=q("Looks like there aren't any files here yet. "),l=p("br"),i=q(`
            Try uploading one by dropping it here or by clicking the upload button.`),this.h()},l(a){e=h(a,"P",{class:!0});var o=b(e);t=L(o,"Looks like there aren't any files here yet. "),l=h(o,"BR",{}),i=L(o,`
            Try uploading one by dropping it here or by clicking the upload button.`),o.forEach(u),this.h()},h(){f(e,"class","bold svelte-13gsupi")},m(a,o){_(a,e,o),d(e,t),d(e,l),d(e,i)},p:M,i:M,o:M,d(a){a&&u(e)}}}function Ee(s){let e,t;return e=new et({props:{roomName:s[0],file:s[2],index:s[4]}}),{c(){O(e.$$.fragment)},l(l){S(e.$$.fragment,l)},m(l,i){j(e,l,i),t=!0},p(l,i){const a={};i&1&&(a.roomName=l[0]),i&2&&(a.file=l[2]),i&2&&(a.index=l[4]),e.$set(a)},i(l){t||(E(e.$$.fragment,l),t=!0)},o(l){C(e.$$.fragment,l),t=!1},d(l){V(e,l)}}}function Ce(s,e){let t,l,i,a=e[2]!=null&&Ee(e);return{key:s,first:null,c(){t=P(),a&&a.c(),l=P(),this.h()},l(o){t=P(),a&&a.l(o),l=P(),this.h()},h(){this.first=t},m(o,r){_(o,t,r),a&&a.m(o,r),_(o,l,r),i=!0},p(o,r){e=o,e[2]!=null?a?(a.p(e,r),r&2&&E(a,1)):(a=Ee(e),a.c(),E(a,1),a.m(l.parentNode,l)):a&&(oe(),C(a,1,1,()=>{a=null}),ae())},i(o){i||(E(a),i=!0)},o(o){C(a),i=!1},d(o){o&&u(t),a&&a.d(o),o&&u(l)}}}function ot(s){let e,t,l,i;const a=[lt,tt],o=[];function r(n,c){return n[1].files.length==0?0:1}return t=r(s),l=o[t]=a[t](s),{c(){e=p("main"),l.c()},l(n){e=h(n,"MAIN",{});var c=b(e);l.l(c),c.forEach(u)},m(n,c){_(n,e,c),o[t].m(e,null),i=!0},p(n,[c]){let m=t;t=r(n),t===m?o[t].p(n,c):(oe(),C(o[m],1,1,()=>{o[m]=null}),ae(),l=o[t],l?l.p(n,c):(l=o[t]=a[t](n),l.c()),E(l,1),l.m(e,null))},i(n){i||(E(l),i=!0)},o(n){C(l),i=!1},d(n){n&&u(e),o[t].d()}}}function at(s,e,t){let{roomName:l}=e,{roomData:i}=e;return s.$$set=a=>{"roomName"in a&&t(0,l=a.roomName),"roomData"in a&&t(1,i=a.roomData)},[l,i]}class it extends G{constructor(e){super(),W(this,e,at,ot,J,{roomName:0,roomData:1})}}function rt(s){let e,t;return{c:M,l:M,m(l,i){e||(t=[ne(window,"dragover",_e(s[2])),ne(window,"drop",_e(s[0]))],e=!0)},p:M,i:M,o:M,d(l){e=!1,Ue(t)}}}function st(s,e,t){let{handleUpload:l}=e;const i=o=>{let r=o.dataTransfer.items;if(r){let n=[];for(let c of r)c.kind=="file"&&n.push(c.getAsFile());n.length!=0&&l(n)}};function a(o){qe.call(this,s,o)}return s.$$set=o=>{"handleUpload"in o&&t(1,l=o.handleUpload)},[i,l,a]}class nt extends G{constructor(e){super(),W(this,e,st,rt,J,{handleUpload:1})}}function De(s){let e,t,l,i;return e=new it({props:{roomName:s[1],roomData:s[0]}}),l=new nt({props:{handleUpload:s[6]}}),{c(){O(e.$$.fragment),t=D(),O(l.$$.fragment)},l(a){S(e.$$.fragment,a),t=I(a),S(l.$$.fragment,a)},m(a,o){j(e,a,o),_(a,t,o),j(l,a,o),i=!0},p(a,o){const r={};o&2&&(r.roomName=a[1]),o&1&&(r.roomData=a[0]),e.$set(r)},i(a){i||(E(e.$$.fragment,a),E(l.$$.fragment,a),i=!0)},o(a){C(e.$$.fragment,a),C(l.$$.fragment,a),i=!1},d(a){V(e,a),a&&u(t),V(l,a)}}}function ft(s){let e,t,l,i,a,o;t=new Be({}),i=new We({props:{isNetworkError:s[3],loading:s[2],popupMessageCode:s[4],handlePopupClose:s[5]}});let r=!s[2]&&De(s);return{c(){e=p("main"),O(t.$$.fragment),l=D(),O(i.$$.fragment),a=D(),r&&r.c()},l(n){e=h(n,"MAIN",{});var c=b(e);S(t.$$.fragment,c),l=I(c),S(i.$$.fragment,c),a=I(c),r&&r.l(c),c.forEach(u)},m(n,c){_(n,e,c),j(t,e,null),d(e,l),j(i,e,null),d(e,a),r&&r.m(e,null),o=!0},p(n,[c]){const m={};c&8&&(m.isNetworkError=n[3]),c&4&&(m.loading=n[2]),c&16&&(m.popupMessageCode=n[4]),i.$set(m),n[2]?r&&(oe(),C(r,1,1,()=>{r=null}),ae()):r?(r.p(n,c),c&4&&E(r,1)):(r=De(n),r.c(),E(r,1),r.m(e,null))},i(n){o||(E(t.$$.fragment,n),E(i.$$.fragment,n),E(r),o=!0)},o(n){C(t.$$.fragment,n),C(i.$$.fragment,n),C(r),o=!1},d(n){n&&u(e),V(t),V(i),r&&r.d()}}}function ct(s,e,t){let i,a,o=!0,r,n=!1,c=-1;const m=w=>{t(4,c=-1)},k=async w=>{let N=Date.now();try{let T=await fetch(`/room/get/${a}`);T.ok?t(0,i=await T.json()):(t(0,i=null),t(3,n=!1))}catch{t(0,i=null),t(3,n=!0)}i?o&&(r=setTimeout(T=>{t(2,o=!1)},750-(Date.now()-N))):(t(2,o=!0),r!=null&&clearTimeout(r))},y=w=>{location.href="/"},z=w=>{let N=!1;for(let T of w){if(T.size>le.max.fileSize){N=!0;continue}let B=new FormData;B.set("upload",T),fetch(`room/upload/${a}`,{method:"POST",body:B}).catch(F=>{console.log(F.name)}),t(0,i.files[i.files.length]={fileName:T.name,timeLeft:0,ready:!1,uploadProgress:0,size:T.size},i)}N&&t(4,c=0)};return Le(async w=>{if(t(1,a=location.hash.slice(1)),a==""){y();return}await Ae(Fe,k),setInterval(k,le.timings.refreshDelay*1e3)}),[i,a,o,n,c,m,z]}class gt extends G{constructor(e){super(),W(this,e,ct,ft,J,{})}}export{gt as default};
